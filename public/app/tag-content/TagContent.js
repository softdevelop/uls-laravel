function humanized_time_span(e,t,n,a){function i(){for(var e=0;e<n[u].length;e++)if(null==n[u][e].ceiling||s<=n[u][e].ceiling)return n[u][e];return null}function r(){for(var e=s,t={},n=0;n<a.length;n++){var i=Math.floor(e/a[n][0]);e-=a[n][0]*i,t[a[n][1]]=i}return t}function o(e){var t=r(),n=e.text.replace(/\$(\w+)/g,function(){return t[arguments[1]]});return l(n,t)}function l(e,t){for(var n in t)if(1==t[n]){var a=new RegExp("\\b"+n+"\\b");e=e.replace(a,function(){return arguments[0].replace(/s\b/g,"")})}return e}if(n=n||{past:[{ceiling:60,text:"$seconds seconds ago"},{ceiling:3600,text:"$minutes minutes ago"},{ceiling:86400,text:"$hours hours ago"},{ceiling:2629744,text:"$days days ago"},{ceiling:31556926,text:"$months months ago"},{ceiling:null,text:"$years years ago"}],future:[{ceiling:60,text:"in $seconds seconds"},{ceiling:3600,text:"in $minutes minutes"},{ceiling:86400,text:"in $hours hours"},{ceiling:2629744,text:"in $days days"},{ceiling:31556926,text:"in $months months"},{ceiling:null,text:"in $years years"}]},a=a||[[31556926,"years"],[2629744,"months"],[86400,"days"],[3600,"hours"],[60,"minutes"],[1,"seconds"]],"Invalid Date"==new Date(e))for(;-1!=String(e).indexOf("-");)e=e.replace("-","/");e=new Date(e),t=t?new Date(t):new Date;var s=(t-e)/1e3,u="past";return 0>s&&(u="future",s=0-s),o(i())}angular.module("user",[]),angular.module("permission",[]),angular.module("role",[]),angular.module("multiSelect",[]),angular.module("ticket",[]),angular.module("type",[]),angular.module("dataOption",[]),angular.module("nlcFilter",[]),angular.module("file",[]),angular.module("AppLanguage",[]),angular.module("TemplateManagerApp",[]),angular.module("RegionApp",[]),angular.module("campaignApp",[]),angular.module("campaignDetailApp",[]),angular.module("MarketsegmentApp",[]),angular.module("notification",[]),angular.module("transApp",[]),angular.module("assetManager",[]),angular.module("BlockApp",[]),angular.module("ChannelPartnersApp",[]),angular.module("roleGroup1",[]),angular.module("filedType",[]),angular.module("filed",[]),angular.module("term",[]),angular.module("customFormatDate",[]),angular.module("SeoAnalysisApp",[]),angular.module("pageApp",[]),angular.module("treeresizer",[]),angular.module("CreatePageApp",[]),angular.module("EditDraftApp",[]),angular.module("fomatHtml",[]),angular.module("colorpicker.module",[]),angular.module("formBuilderDirectiveApp",[]),angular.module("appManageTerm",[]),angular.module("TermTemplateManagerApp",[]),angular.module("configurator",[]),angular.module("TemplateContentManager",[]),angular.module("cmsContentFolderApp",[]),angular.module("lowercaseCharater",[]),angular.module("selectLevel",[]),angular.module("modalSelectLevel",[]),angular.module("configField",[]),angular.module("cmsContentInsertApp",[]),angular.module("confirmDirective",[]),angular.module("CmsApp",[]),angular.module("checkLimitAndChangeDateTimeDirectiveApp",[]),angular.module("tagContentApp",[]),angular.module("tagContentDirective",[]),angular.module("cmsContentTagApp",[]),angular.module("viewDraft",[]),angular.module("databaseManager",[]),angular.module("selectLevelDatabase",[]),angular.module("modalSelectPage",[]),angular.module("configFormDatabaseApp",[]),angular.module("historyApp",[]);var defaultModules=["ui.bootstrap","ngResource","ngCookies","ngFileUpload","ngRoute","toggle-switch","ngImgCrop","ngTable","user","role","permission","multiSelect","ticket","type","dataOption","nlcFilter","file","xeditable","timer","AppLanguage","TemplateManagerApp","RegionApp","campaignApp","campaignDetailApp","MarketsegmentApp","notification","transApp","assetManager","BlockApp","ChannelPartnersApp","roleGroup1","filedType","filed","term","ui-iconpicker","customFormatDate","SeoAnalysisApp","pageApp","treeresizer","CreatePageApp","EditDraftApp","fomatHtml","colorpicker.module","formBuilderDirectiveApp","appManageTerm","TermTemplateManagerApp","mgo-angular-wizard","configurator","TemplateContentManager","cmsContentFolderApp","lowercaseCharater","selectLevel","configField","cmsContentInsertApp","confirmDirective","CmsApp","checkLimitAndChangeDateTimeDirectiveApp","tagContentApp","tagContentDirective","cmsContentTagApp","viewDraft","modalSelectLevel","databaseManager","selectLevelDatabase","modalSelectPage","configFormDatabaseApp","historyApp"];"undefined"!=typeof modules&&(defaultModules=defaultModules.concat(modules));var myApp=angular.module("uls",defaultModules);angular.module("uls").run(["editableOptions",function(e){e.theme="bs3"}]),angular.module("uls").config(["$logProvider",function(e){e.debugEnabled(window.debug)}]),myApp.config(["$httpProvider",function(e){e.interceptors.push(["$q",function(e){e.defer();return{responseError:function(t){var n=angular.element(".butterbar-container");switch(t.status){case 401:return void(window.location.href=window.baseUrl);case 404:n.hasClass("hidden")&&n.removeClass("hidden");break;case 500:n.hasClass("hidden")&&n.removeClass("hidden")}return jQuery.ajax({url:"/log/add",method:"post",data:{response:t.data,status:t.status},success:function(e){}}),e.reject(t)}}}])}]),function(e){function t(){var t=window.innerHeight;e(".table-responsive.set-height, .table-responsive#tb-group-user, .table-animate").css({height:t-150+"px"}),e("#search-page,.box-maps").css({height:t-105+"px"}),e(".box-list-rep").css({height:t-100+"px"}),e("#load-maps").css({height:t-185+"px"})}e(document).ready(t),e(window).resize(t),e(document).ready(function(){e(".dropdown-menu table tr td button").removeAttr("style")}),e(document).ready(function(){setTimeout(function(){var t=e("#frame_html").contents().find("head");t.append('<style type="text/css">.area_toolbar{background-color:#f1f1f1;}#editor{border:solid #ccc 1px}#result{border-top:solid #ccc 1px;border-bottom: solid #ccc 1px}.editarea_popup{box-shadow: 0px 4px 36px rgba(177, 177, 177, 0.75);border: solid 1px #CCCCCC;background-color: #FFFFFF;}.area_toolbar select{font-size:9pt;background-color:#fff}</style>')},1e3)}),e(window).load(function(){e(".step3 .show-more").click(function(){e(".step3 .wrap-more-product").toggleClass("show")})});var n,a,i,r,o,l,s;e(".next").click(function(){return s?!1:(s=!0,n=e(this).parent(),a=e(this).parent().next(),a.show(),void n.animate({opacity:0},{step:function(e,t){l=1-.2*(1-e),r=50*e+"%",o=1-e,n.css({transform:"scale("+l+")"}),a.css({left:r,opacity:o})},duration:800,complete:function(){n.hide(),s=!1},easing:"easeInOutBack"}))}),e(".previous").click(function(){return s?!1:(s=!0,n=e(this).parent(),i=e(this).parent().prev(),i.show(),void n.animate({opacity:0},{step:function(e,t){l=.8+.2*(1-e),r=50*(1-e)+"%",o=1-e,n.css({left:r}),i.css({transform:"scale("+l+")",opacity:o})},duration:800,complete:function(){n.hide(),s=!1},easing:"easeInOutBack"}))}),e(".submit").click(function(){return!1})}(jQuery),angular.module("uls").controller("BaseController",["$scope","$parse","$timeout","$modal","UserService","AssetManagerService",function(e,t,n,a,i,r){if(angular.element(".wrapper").removeClass("hidden"),i.setData(window.usersMap),n(function(){"undefined"!=typeof e.callbackLoadUserFinish&&(e.callbackLoadUserFinish(),e.users_map=i.getUsersMap())}),e.testFuture=window.testFuture,1==e.testFuture&&angular.element(".test").removeClass("hidden"),e.windowType=window.info,"undefined"!=typeof window.info)for(var o in window.info){var l=t(o);l.assign(e,window.info[o])}e.initDate=function(){angular.element(".date").bdatepicker({format:"yyyy-mm-dd"})},e.viewModalImage=function(e){var t=a.open({templateUrl:baseUrl+"/app/components/termTemplateManager/views/modal/viewImage.html",controller:"ModalViewPictureCtrl",size:void 0,windowClass:"show-img",resolve:{fileId:function(){return e}}});t.result.then(function(e){},function(){})},e.urlForm=[],e.getUrlImageAssetForm=function(t,n){"undefined"==typeof e.urlForm[t]&&(e.urlForm[t]=[]),r.getUrlImageAsset(t).then(function(a){e.urlForm[t][n]=a.url})},e.removeThumbnailAssertForm=function(t,n){e.urlForm[t][n]=""}}]).controller("ModalViewPictureCtrl",["$scope","$modalInstance","fileId",function(e,t,n){e.fileId=n,e.baseUrl=baseUrl,e.cancel=function(){t.dismiss("cancel")}}]);var userModule=angular.module("user");userModule.factory("UserResource",["$resource",function(e){return e("/api/user/:method/:id",{method:"@method",id:"@id"},{add:{method:"post"},save:{method:"post"},update:{method:"put"}})}]).factory("UserService",["$q","$filter","UserResource",function(e,t,n){var a=[],i=[],r=[],o=this,l={},s={};return this.setHashData=function(e){l=e},this.create=function(t){if("undefined"!=typeof t.id)return o.update(t);var i=e.defer(),r=new n(t);return r.$save({},function(e){e.status&&e.item&&(a.push(e.item),"undefined"==typeof e.item.last_login&&(e.item.last_login="0000-00-00 00:00:00")),i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.changePassword=function(t){var a=e.defer(),i=new n(t);return i.$save({method:"change-password",id:t.id},function(e){e.status?a.resolve(e):a.reject(e)},function(e){a.reject(e.data)}),a.promise},this.changeRoles=function(t){var a=e.defer(),i=new n(t);return i.$save({method:"change-roles"},function(e){e?a.resolve(e):a.reject(e)},function(e){a.reject(e.data)}),a.promise},this.update=function(t){var i=e.defer(),r=new n(t);return r.$update({id:t.id},function(e){if(e.status)for(var t in a)if(a[t].id==e.item.id){a[t]=e.item;break}i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.get=function(t){var a=e.defer();return n.get({id:t},function(e){a.resolve(e)}),a.promise},this.query=function(){var t=e.defer();return n.query(function(e){a=e,t.resolve(e)}),t.promise},this.queryUsersManager=function(){var t=e.defer();return n.query({method:"get-all-user-manager"},function(e){a=e,t.resolve(e)}),t.promise},this.remove=function(t){var i=e.defer();return n["delete"]({id:t},function(e){if(e.status)for(var n in a)if(a[n].id==t){a[n].status="no";break}i.resolve(e)}),i.promise},this.pushUser=function(e){a.push(e)},this.updateUser=function(e){for(var t in a)if(a[t].id==e.id){e.status="yes",a[t]=e;break}},this.changeAvatar=function(t,a){var i=e.defer();return n.save({method:"change-avatar",file:a,id:t},function(e){i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.resetPassword=function(t){var a=e.defer();return n.save({method:"email",entity:"password",email:t},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.getUsers=function(){return a},this.getUserById=function(e){return s[e]},this.getUsersMap=function(){return s},this.listMap=function(e,t){if("role"==t)for(var n in e)i[e[n].id]=e[n];else for(var n in e)r[e[n].id]=e[n]},this.getMap=function(e){return"role"==e?i:r},this.userBranchManager=function(t){var a=e.defer();return n.query({id:t,method:"get-users-branch-manager"},function(e){a.resolve(e)}),a.promise},this.updatePermissions=function(t,a){var i=e.defer();return n.save({id:t,permissionIds:a,method:"update-permission"},function(e){i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.updateGroup=function(t,a){var i=e.defer();return n.save({id:t,groupIds:a,method:"update-group"},function(e){i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.updateRoles=function(t,a){var i=e.defer();return n.save({id:t,roleIds:a,method:"update-role"},function(e){i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.changeStatus=function(t){var i=e.defer();return n["delete"]({id:t,method:"change-status"},function(e){if(e.status)for(var n in a)if(a[n].id==t){a[n].status="yes";break}i.resolve(e)}),i.promise},this.setData=function(e){a=e;for(var t in e)s[e[t].id]=e[t];return localStorage.setItem("users",JSON.stringify(a)),localStorage.setItem("users_by_key",JSON.stringify(s)),a},this.updateShowDueDateUser=function(t){var a=e.defer(),i=new n(t);return i.$save({method:"update-show-due-date-user"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this}]);var assetmanagerApp=angular.module("assetManager",["ngResource","ui.bootstrap","ngSanitize","ngTable"]);assetmanagerApp.factory("AssetManagerResource",["$resource",function(e){return e("/api/asset-manager/:method/:id",{method:"@method",id:"@id"},{add:{method:"post"},save:{method:"post"},update:{method:"put"},editNameFolder:{method:"edit-name-folder"}})}]).service("AssetManagerService",["AssetManagerResource","$q",function(e,t){var n=this,a=[];this.createFolderProvider=function(a){if("undefined"!=typeof a.id)return n.editFolderAndFile(a);var i=t.defer(),r=new e(a);return r.$save({method:"create-folder"},function(e){i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.uploadNewAsset=function(n){var i=t.defer(),r=new e(n);return r.$save({method:"upload-new-asset"},function(e){0!=e.status&&a.push(e.item),i.resolve(e.item)},function(e){i.resolve(e.data)}),i.promise},this.createNewAsset=function(n){var i=t.defer(),r=new e(n);return r.$save({method:"create-new-asset"},function(e){0!=e.status&&a.push(e.item),i.resolve(e.item)},function(e){i.resolve(e.data)}),i.promise},this.saveFieldFile=function(n){var a=t.defer(),i=new e(n);return i.$save({method:"save-file-asset"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.editFile=function(n){var a=t.defer(),i=new e(n);return i.$save({method:"edit-file"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.addTagsForPage=function(n,a){var i=t.defer(),r=new e(a);return r.$save({id:n,method:"add-tags"},function(e){0!=e.status,i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.getAssetManagerById=function(n){var a=t.defer(),i=new e;return i.$get({id:n},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.setAssetManagers=function(e){return a=e},this.getAssetManagers=function(){return a},this.getUrlImageAsset=function(n){var a=t.defer();return e.get({id:n,method:"get-url-image-asset"},function(e){a.resolve(e)}),a.promise},this.deleteFolderAndAsset=function(n){var a=t.defer(),i=new e;return i.$delete({id:n},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.deleteAssetFile=function(n){var a=t.defer(),i=new e;return i.$get({id:n,method:"delete-file"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.editNameFolder=function(n){var a=t.defer(),i=new e(n);return i.$save({id:n.id,method:"edit-name-folder"},function(e){0!=e.status&&a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.updateContentFile=function(n,a){var i=t.defer(),r=new e(a);return r.$save({id:n,method:"update-content-file"},function(e){i.resolve(e)},function(e){i.resolve(e.data)}),i.promise}}]),angular.module("uls").controller("NotificationController",["$scope","$filter","NotificationService","$controller","$timeout",function(e,t,n,a,i){function r(){}function o(){if(f=!1,c.length>0){var e=c.shift();s(e)}}function l(){}function s(t){if(f)return void c.push(t);f=!0;var n=e.users_map[t.data.sender_id].avatar,a=new Notify("Notification",{icon:n,body:t.data.message,tag:t.data.sender_id,notifyShow:r,notifyClose:o,notifyClick:function(){window.location.href="/"+t.data.href},notifyError:l,timeout:5});a.show()}a("BaseController",{$scope:e}),e.callbackLoadUserFinish=function(){},angular.element("#notification-top").removeClass("hidden"),e.baseUrl=window.baseUrl;var u=10;e.limitTo=u;var d=1;e.notifications=[];var c=[],f=!1;e.amount=0,$(".scroll-noti1").scroll(function(){$(this)[0].scrollHeight-$(this).scrollTop()===$(this).outerHeight()&&e.$apply(function(){e.limitTo=e.limitTo+u})});var p=RowboatPusher.subscribe("notification_ticket");p.bind("Rowboat\\Notification\\Events\\Notifications\\Broadcast\\NotificationTicket",function(t){e.$apply(function(){"undefined"!=typeof t.data.user_id&&-1!=t.data.user_id.indexOf(window.userId)&&(s(t),d=1,e.amount++)})}),e.getNotifications=function(){n.query(d).then(function(t){e.notifications=t,e.hightlight=angular.copy(e.amount),e.amount=0,d=0})},n.getAmountNotificationsNotRead().then(function(t){e.amount=t.result})}]);var permissionModule=angular.module("notification");permissionModule.factory("NotificationResource",["$resource",function(e){return e("/api/notification/:method/:id",{},{add:{method:"post"},save:{method:"post"}})}]).service("NotificationService",["$q","$filter","NotificationResource",function(e,t,n){var a=[];this.getAmountNotificationsNotRead=function(t){var a=e.defer();return n.get({method:"amount-notifications-not-read"},function(e){a.resolve(e)}),a.promise},this.query=function(t){var i=e.defer();return t?n.query().$promise.then(function(e){a=e,i.resolve(a)}):i.resolve(a),i.promise},this.notificationInvite=function(t){var a=e.defer(),i=new n(t);return i.$save({data:t,method:"invite"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise}}]),notificationModule=angular.module("notification"),notificationModule.directive("notification",[function(){return{restrict:"AE",scope:{item:"="},replace:!0,templateUrl:baseUrl+"/app/shared/notification/views/notification.html",link:function(){}}}]);var module=angular.module("uls");module.directive("rowboatRequired",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){"undefined"==typeof e.$eval(n.ngModel)&&a.$setValidity("rowboatRequired",!1),t.on("focus",function(i){e.$watch(n.ngModel,function(e){var n="undefined"!=typeof e&&0!=e.length;if(n)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatRequired",n);else if(0==t.parent().find("span").length){t.parent().addClass("error");var i='<span class="control-label">It is required</span>';t.parent().append(i),a.$setValidity("rowboatRequired",n)}})})}}}),module.directive("rowboatLength",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){"undefined"!=typeof e.$eval(n.ngModel)&&e.$eval(n.ngModel).length!=n.rowboatLength&&a.$setValidity("rowboatLength",!1),t.on("focus",function(i){e.$watch(n.ngModel,function(e){var i=n.rowboatLength,r="undefined"!=typeof e&&e.length==i;if(r)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatLength",r);else if(0==t.parent().find("span").length){t.parent().addClass("error");var o='<span class="control-label">Length is '+i+"</span>";t.parent().append(o),a.$setValidity("rowboatLength",r)}})})}}}),module.directive("rowboatMinLength",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){"undefined"!=typeof e.$eval(n.ngModel)&&e.$eval(n.ngModel).length<n.rowboatMinLength&&a.$setValidity("rowboatMinLength",!1),t.on("focus",function(i){e.$watch(n.ngModel,function(e){var i=n.rowboatMinLength,r="undefined"!=typeof e&&e.length>=i;if(r)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatMinLength",r);else if(0==t.parent().find("span").length){t.parent().addClass("error");var o='<span class="control-label">Min length is '+i+"</span>";t.parent().append(o),a.$setValidity("rowboatMinLength",r)}})})}}}),module.directive("rowboatMaxLength",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){"undefined"!=typeof e.$eval(n.ngModel)&&e.$eval(n.ngModel).length>n.rowboatMaxLength&&a.$setValidity("rowboatMaxLength",!1),t.on("focus",function(i){e.$watch(n.ngModel,function(e){var i=n.rowboatMaxLength,r="undefined"!=typeof e&&e.length<=i;if(r)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatMaxLength",r);else if(0==t.parent().find("span").length){t.parent().addClass("error");var o='<span class="control-label">Max length is '+i+"</span>";t.parent().append(o),a.$setValidity("rowboatMaxLength",r)}})})}}}),module.directive("rowboatEmailPattern",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){$pattern=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/,"undefined"==typeof e.$eval(n.ngModel)&&a.$setValidity("rowboatEmailPattern",!1),t.on("blur",function(i){e.$watch(n.ngModel,function(e){var n="undefined"!=typeof e&&$pattern.test(e);if(n)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatEmailPattern",n);else if(0==t.parent().find("span").length){t.parent().addClass("error");var i='<span class="control-label">Email Invalid</span>';t.parent().append(i),a.$setValidity("rowboatEmailPattern",n)}})})}}});var filterDate=angular.module("customFormatDate",[]);filterDate.filter("myDate",["$filter",function(e){return function(t,n){if(null==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var a=e("date")(new Date(String(t)),angular.isUndefined(n)?"MM-dd-yyyy":n);return String(a)}}]).filter("myDateL",["$filter",function(e){return function(t){if(null==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var n=e("date")(new Date(String(t)),"MMMM d, y");return String(n)}}]).filter("myDateTime",["$filter",function(e){return function(t){if(null==t)return"";if("0000-00-00 00:00:00"==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var n=e("date")(new Date(String(t)),"MM-dd-yyyy HH:mm:ss");return String(n)}}]).filter("myDateShortTime",["$filter",function(e){return function(t){if(null==t)return"";if("0000-00-00 00:00:00"==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var n=e("date")(new Date(String(t)),"MM-dd-yyyy h:mma");return String(n)}}]).filter("clientDate",["$filter",function(e){return function(t,n){if(null==t)return"";if("0000-00-00 00:00:00"==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";t=new Date(t),t=new Date(parseInt(new Date(t).getTime())-60*parseInt((new Date).getTimezoneOffset())*1e3);var a=e("date")(new Date(String(t)),angular.isUndefined(n)?"MM-dd-yyyy":n);return String(a)}}]),angular.module("nlcFilter").filter("elapsedtime",function(){return function(e){return humanized_time_span(e)}});var tagContentApp=angular.module("tagContentApp");tagContentApp.factory("TagContentResource",["$resource",function(e){return e("/site-configuration/api/tag-content/:method/:id",{method:"@method",id:"@id"},{add:{method:"post"},save:{method:"post"},update:{method:"put"},check:{method:"post"}})}]).service("TagContentService",["TagContentResource","$q",function(e,t){var n=[],a=this;this.createTagContent=function(i,r){if("edit"==r)return a.editTagContent(i);var o=t.defer(),l=new e(i);return l.$save({},function(e){0!=e.status&&(n=e.tagsContent),o.resolve(e)},function(e){o.resolve(e.data)}),o.promise},this.editTagContent=function(a){var i=t.defer(),r=new e(a);return r.$update({id:a._id},function(e){0!=e.status&&(n=e.tagsContent),i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.deleteTag=function(a){var i=t.defer(),r=new e;return r.$delete({id:a},function(e){0!=e.status&&(n=e.tagsContent),i.resolve(e)},function(e){i.resolve(e.data)}),i.promise},this.setTagContent=function(e){return n=e},this.getTagContent=function(){return n}}]);var tagContentApp=angular.module("tagContentApp");tagContentApp.controller("TagContentController",["$modal","ngTableParams","$timeout","$filter","TagContentService",function(e,t,n,a,i){that=this,this.isSearch=!1,this.tagsContent=i.setTagContent(angular.copy(window.tagsContent)),angular.isDefined(this.tagsContent)&&(this.tableParams=new t({page:1,count:10,sorting:{name:"asc"}},{total:that.tagsContent.length,getData:function(e,t){var n=t.filter()?a("filter")(that.tagsContent,t.filter()):that.tagsContent;n=t.sorting()?a("orderBy")(n,t.orderBy()):n,e.resolve(n.slice((t.page()-1)*t.count(),t.page()*t.count()))}})),this.getModalTagContent=function(t,a){var r="0";if("0"!=t&&"create"==a&&(r=t._id),"edit"==a)var o="/site-configuration/tag-content/"+t._id+"/edit?"+(new Date).getTime();else o="/site-configuration/tag-content/create?parentId="+r+"&dateTime="+(new Date).getTime();var l=e.open({animation:this.animationsEnabled,templateUrl:window.baseUrl+o,controller:"ModalCreateTagContentCtrl",size:null,resolve:{parentId:function(){return r},type:function(){return a}}});l.result.then(function(e){that.tagsContent=i.getTagContent(),that.tableParams.reload(),"0"!=t&&n(function(){$("#show-sub-select-"+t._id).addClass("in"),$(".btn-toggle-"+t._id).find("i:first").removeClass("fa-plus").addClass("fa-minus"),angular.forEach(t.parentIds,function(e,t){$("#show-sub-select-"+e).addClass("in"),$(".btn-toggle-"+e).find("i:first").removeClass("fa-plus").addClass("fa-minus")})})},function(){})},this.deleteTagContent=function(e){i.deleteTag(e._id).then(function(t){that.tagsContent=i.getTagContent(),that.tableParams.reload(),"0"!=e&&n(function(){angular.forEach(e.parentIds,function(e,t){$("#show-sub-select-"+e).addClass("in"),$(".btn-toggle-"+e).find("i:first").removeClass("fa-plus").addClass("fa-minus")})})})},this.showGroup=function(e){var t=$(window).outerWidth();$(".wrap-ac-group").each(function(e){$(this).removeClass("ac-up")}),$(e.target).parent().toggleClass("ac-up"),$(".group-btn-ac").hasClass("fix-missing-li")?$(".group-btn-ac").css({top:e.pageY-65+"px",right:t-e.pageX-30+"px"}):$(".group-btn-ac").css({top:e.pageY-140+"px",right:t-e.pageX-30+"px"}),$(document).on("click",function n(e){$(e.target).closest("tr").siblings().find(".wrap-ac-group").removeClass("ac-up"),0===$(".wrap-ac-group").has(e.target).length?$(".wrap-ac-group").removeClass("ac-up"):$(document).one("click",n)}),angular.element(".table-responsive").addClass("fix-height")},this.showSubSelect=function(e,t){e.preventDefault(),$(e.currentTarget).addClass("fa-plus"),$(e.currentTarget).toggleClass("fa-minus");var n=$(e.currentTarget).closest("tr").css("backgroundColor");$(e.currentTarget).closest("li").find("ul").find("tr").css("backgroundColor",n.slice(0,-1)+", 0.1)")}}]).controller("ModalCreateTagContentCtrl",["$scope","$modalInstance","TagContentService","parentId","type",function(e,t,n,a,i){e.submit=function(r){e.submitted=!0,r||(e.tagContent.parent_id=a,n.createTagContent(e.tagContent,i).then(function(n){e.nameExists="",0==n.status?e.nameExists=n.error:t.close(n)}))},e.cancel=function(){t.dismiss("cancel")}}]),function(e){angular.module("formBuilderDirectiveApp",[]).directive("switchBootstrap",["$parse","$timeout",function(e,t){return{restrict:"A",require:"?ngModel",link:function(e,t,n,a){t.bootstrapSwitch(),t.on("switchChange.bootstrapSwitch",function(t,n){a&&e.$apply(function(){a.$setViewValue(n)})}),e.$watch(n.ngModel,function(e,n){e?t.bootstrapSwitch("state",!0,!0):t.bootstrapSwitch("state",!1,!0)})}}}]).directive("select2",["$timeout",function(t){return{restrict:"A",require:"?ngModel",replace:!0,link:function(n,a,i,r){function o(t){return t.id&&"? undefined:undefined ?"!=t.id?e("<span>"+t.text+"</span>"):"Select item"}t(function(){e(a).select2({templateResult:o}),e(a).removeClass("form-control ")},1e3)}}}]).directive("multiSelect",["$parse","$timeout",function(t,n){return{restrict:"A",require:"ngModel",link:function(a,i,r,o){var l=t(r.ngModel),s=angular.copy(l(a));"undefined"==typeof s&&(s=[]),e(i)[0].selectedIndex=-1,e(i).multiSelect({afterInit:function(e){},afterSelect:function(e){"undefined"==typeof s?s=e:(null==s&&(s=[]),-1==s.indexOf(e[0])&&(s[s.length]=e[0])),a.$apply(function(){o.$setViewValue(s)})},afterDeselect:function(e){s=_.uniq(s);for(var t in s)s[t]==e[0]&&s.splice(t,1);a.$apply(function(){0==s.length&&(s=null),o.$setViewValue(s)})}}),n(function(){e(i).multiSelect("select",_.uniq(s))})}}}]).directive("colorPicker",["$parse","$compile","$timeout",function(t,n,a){return{restrict:"A",require:"ngModel",link:function(n,a,i,r){function o(e,t){e.$setViewValue(t),e.$render()}function l(e,t){var n;return n=e.length>5?-1!=r.$viewValue.indexOf("#")?String(e).substring(1,7):String(e).substring(1,6):e}var s=t(i.ngModel),u=s(n);null==u&&(u="#f00"),o(r,u),e(a).spectrum({color:u,preferredFormat:"hex",allowEmpty:!0,showInitial:!0,showInput:!0,change:function(e){o(r,e.toHexString()),r.$parsers.push(function(e){return r.$viewValue=l(e,r),r.$render(),-1==r.$viewValue.indexOf("#")&&(r.$viewValue="#"+r.$viewValue),r.$viewValue})}})}}}]).directive("datepickerRowboat",["$compile",function(e){return{restrict:"A",require:"?ngModel",link:function(e,t,n,a){t.bind("click",function(){var t=n.isOpen;e.$apply(function(){angular.isUndefined(e[t])?e[t]=!0:e[t]=!e[t]})})}}}]).directive("uimaskRowboat",["$compile",function(e){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){var i=t.attr("ui-mask");t.mask(i)}}}]).directive("redactor",["$compile","$timeout",function(t,n){return{restrict:"A",require:"?ngModel",link:function(t,a,i,r){e(a).redactor({replaceDivs:!1,imageUpload:"/content/upload",set:"Your text goes here",removeEmpty:["strong","em","span","p"],plugins:["table"],callbacks:{paste:function(t){var n=this.code.get();!t||"<div></div>"!=n&&""!=n&&"<br>"!=n||e(a).load(t)},enter:function(e){var t=this.code.get();("<div></div>"==t||"<div><br></div>"==t||""==t||"<br>"==t)&&this.code.set("")},blur:function(e){var n=this.code.get();("<div></div>"==n||""==n||"<br>"==n)&&(n="",this.code.set(""),t.checkRequired=!0),r.$setViewValue(n)},change:function(e){var n=this.code.get();("<div></div>"==n||""==n||"<br>"==n)&&(this.code.set(""),t.checkRequired=!0),r.$setViewValue(n)},init:function(){n(function(){r.$modelValue&&angular.isDefined(r.$modelValue)&&e(a).redactor("code.set",r.$modelValue)})}},minHeight:300})}}}]).directive("uploadFile",["$http","$parse","$timeout","Upload",function(e,t,n,a){return{restrict:"EA",require:"^ngModel",scope:{files:"=",fileIds:"=",openPicture:"&",disabled:"="},replace:!0,transclude:!0,templateUrl:baseUrl+"/app/shared/form-builder-directive/views/file-upload.html?v="+(new Date).getTime(),link:function(t,i,r,o){function l(e){o.$setViewValue(e),f()}function s(e){var t=["png","gif","jpg","jpeg"];if("undefined"!=typeof e){if(-1!=t.indexOf(e.split("/")[1]))return"image";switch(e.split("/")[1]){case"zip":return"zip";case"pdf":return"pdf";case"msword":return"msword";default:return"other"}}}function u(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function d(e){if(angular.isDefined(t.fileUploaded)&&!t.fileUploaded.length)for(var n in e)t.fileUploaded.push(e[n])}var c=0;t.baseUrl=baseUrl,t.fileUpload={},t.fileUploaded=[],t.fileUploadIds=[],t.fileError={},t.accept=r.accept,t.uploadFinish=!0,t.numberFileUpload=[];var f=t.$watch(function(){r.ngMultiple||(r.ngMultiple="true");var n="true"===r.ngMultiple;if("true"!=r.ngMultiple?(t.ngMultiple=!1,"false"==r.ngMultiple?t.uploadMultiple=n:t.uploadMultiple="one"):(t.ngMultiple=n,t.uploadMultiple=n),"undefined"!=typeof o.$modelValue&&null!=o.$modelValue)if("one"==t.uploadMultiple)e({method:"GET",url:baseUrl+"/upload-form-builder/file/"+o.$modelValue+"?"+(new Date).getTime()}).then(function(e){var n=[];n.uniId=u(),n.proccess=100,n.error=0,n.name=e.data.file_name,n.file_name=e.data.file_name,n.id=e.data.id,n.size=e.data.size,n.type=e.data.type,t.fileUpload[n.uniId]=n,t.fileUploadIds=e.data.id,o.$setViewValue(t.fileUploadIds),d(t.fileUpload)});else for(var a=0;a<o.$modelValue.length;a++)e({method:"GET",url:baseUrl+"/upload-form-builder/file/"+o.$modelValue[a]+"?"+(new Date).getTime()}).then(function(e){var n=[];n.uniId=u(),n.proccess=100,n.error=0,n.name=e.data.file_name,n.file_name=e.data.file_name,n.id=e.data.id,n.size=e.data.size,n.type=e.data.type,t.fileUpload[n.uniId]=n,t.fileUploadIds.push(e.data.id),o.$setViewValue(t.fileUploadIds),a==o.$modelValue.length&&d(t.fileUpload)})},l);t.upload=function(e){if(e&&e.length){c++,angular.isUndefined(t.numberFileUpload[c])&&(t.numberFileUpload[c]=[]);for(var i=0;i<e.length;i++)("image"!=r.accept||r.accept==s(e[i].type))&&!function(i){"one"==t.uploadMultiple&&(t.fileUpload={});var l=e[i];l.uniId=u(),l.proccess=0,l.error="",t.isUploadServe=r.isUploadServe,t.fileUpload[l.uniId]=l,angular.isDefined(window.maxUpload.size)&&l.size>window.maxUpload.size?(angular.isUndefined(t.fileError[l.uniId])&&(t.fileError[l.uniId]={}),t.fileError[l.uniId].status=0,t.fileError[l.uniId].error="Max file size is "+window.maxUpload.name,
t.fileUpload[l.uniId].error="Max file size is "+window.maxUpload.name,t.uploadFinished=!0,o.$setViewValue(t.fileUploadIds)):a.upload({method:"POST",url:baseUrl+"/upload-form-builder/file",file:l,data:r.isUploadServe}).progress(function(e){var n=parseInt(100*e.loaded/e.total);t.fileIsUploading=!0,angular.isDefined(t.fileUpload[l.uniId])&&(t.fileUpload[l.uniId].proccess=n)}).error(function(n,a,r,o){e.splice(1,i),angular.isDefined(t.fileUpload[l.uniId])&&(n&&angular.isDefined(n.message)&&(t.fileUpload[l.uniId].error=n.message),t.fileError[o.file.uniId]=o.file,t.fileError[o.file.uniId].status=n.status)}).success(function(e,n,a,i){angular.isDefined(t.fileUpload[i.file.uniId])&&(t.isUploadServe?(e.item.uniId=i.file.uniId,"one"==t.uploadMultiple?(t.fileUploaded=e.item,t.fileUploadIds=e.item.id):(t.fileUploaded.push(e.item),t.fileUploadIds.push(e.item.id))):"one"==t.uploadMultiple?(t.fileUploaded=i.file.uniId,t.fileUploadIds=i.file):(t.fileUploaded.push(i.file),t.fileUploadIds.push(i.file.uniId)))})["finally"](function(){t.uploadFinished=!0,n(function(){o.$setViewValue(t.fileUploadIds)})})}(i)}},o.$render=function(){t.filesUpload=o.$viewValue},t.checkFile=function(e){return s(e)},t.deleteFile=function(e){if(delete t.fileUpload[e],"one"==t.uploadMultiple)t.fileUploadIds=[],t.uploadFinished=!0,o.$setViewValue(null);else for(var n in t.fileUploaded)if(e==t.fileUploaded[n].uniId){var a=t.fileUploadIds.indexOf(t.fileUploaded[n].id);t.fileUploadIds.splice(a,1),t.uploadFinished=!0,t.fileUploadIds.length?o.$setViewValue(t.fileUploadIds):o.$setViewValue(null)}},t.$on("emptyFiles",function(e,n){t.fileUpload={},t.fileUploaded=[],t.fileUploadIds=[]})}}}]).filter("bytes",function(){return function(e,t){if(isNaN(parseFloat(e))||!isFinite(e))return"-";"undefined"==typeof t&&(t=1);var n=["bytes","kB","MB","GB","TB","PB"],a=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(a))).toFixed(t)+" "+n[a]}})}(jQuery);