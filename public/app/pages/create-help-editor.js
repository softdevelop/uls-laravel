function humanized_time_span(e,t,n,r){function o(){for(var e=0;e<n[s].length;e++)if(null==n[s][e].ceiling||d<=n[s][e].ceiling)return n[s][e];return null}function a(){for(var e=d,t={},n=0;n<r.length;n++){var o=Math.floor(e/r[n][0]);e-=r[n][0]*o,t[r[n][1]]=o}return t}function i(e){var t=a(),n=e.text.replace(/\$(\w+)/g,function(){return t[arguments[1]]});return l(n,t)}function l(e,t){for(var n in t)if(1==t[n]){var r=new RegExp("\\b"+n+"\\b");e=e.replace(r,function(){return arguments[0].replace(/s\b/g,"")})}return e}if(n=n||{past:[{ceiling:60,text:"$seconds seconds ago"},{ceiling:3600,text:"$minutes minutes ago"},{ceiling:86400,text:"$hours hours ago"},{ceiling:2629744,text:"$days days ago"},{ceiling:31556926,text:"$months months ago"},{ceiling:null,text:"$years years ago"}],future:[{ceiling:60,text:"in $seconds seconds"},{ceiling:3600,text:"in $minutes minutes"},{ceiling:86400,text:"in $hours hours"},{ceiling:2629744,text:"in $days days"},{ceiling:31556926,text:"in $months months"},{ceiling:null,text:"in $years years"}]},r=r||[[31556926,"years"],[2629744,"months"],[86400,"days"],[3600,"hours"],[60,"minutes"],[1,"seconds"]],"Invalid Date"==new Date(e))for(;-1!=String(e).indexOf("-");)e=e.replace("-","/");e=new Date(e),t=t?new Date(t):new Date;var d=(t-e)/1e3,s="past";return 0>d&&(s="future",d=0-d),i(o())}angular.module("user",[]),angular.module("permission",[]),angular.module("role",[]),angular.module("multiSelect",[]),angular.module("ticket",[]),angular.module("type",[]),angular.module("dataOption",[]),angular.module("nlcFilter",[]),angular.module("file",[]),angular.module("AppLanguage",[]),angular.module("TemplateManagerApp",[]),angular.module("RegionApp",[]),angular.module("campaignApp",[]),angular.module("campaignDetailApp",[]),angular.module("MarketsegmentApp",[]),angular.module("notification",[]),angular.module("transApp",[]),angular.module("assetManager",[]),angular.module("BlockApp",[]),angular.module("ChannelPartnersApp",[]),angular.module("roleGroup1",[]),angular.module("filedType",[]),angular.module("filed",[]),angular.module("term",[]),angular.module("customFormatDate",[]),angular.module("SeoAnalysisApp",[]),angular.module("pageApp",[]),angular.module("treeresizer",[]),angular.module("CreatePageApp",[]),angular.module("EditDraftApp",[]),angular.module("fomatHtml",[]),angular.module("colorpicker.module",[]),angular.module("formBuilderDirectiveApp",[]),angular.module("appManageTerm",[]),angular.module("TermTemplateManagerApp",[]),angular.module("configurator",[]),angular.module("TemplateContentManager",[]),angular.module("cmsContentFolderApp",[]),angular.module("lowercaseCharater",[]),angular.module("selectLevel",[]),angular.module("modalSelectLevel",[]),angular.module("configField",[]),angular.module("cmsContentInsertApp",[]),angular.module("confirmDirective",[]),angular.module("CmsApp",[]),angular.module("checkLimitAndChangeDateTimeDirectiveApp",[]),angular.module("tagContentApp",[]),angular.module("tagContentDirective",[]),angular.module("cmsContentTagApp",[]),angular.module("viewDraft",[]),angular.module("databaseManager",[]),angular.module("selectLevelDatabase",[]),angular.module("modalSelectPage",[]),angular.module("configFormDatabaseApp",[]),angular.module("historyApp",[]),angular.module("BlockNestedApp",[]),angular.module("selectLevelAsset",[]),angular.module("MaterialApp",[]),angular.module("draganddrop",[]),angular.module("activityLog",[]),angular.module("translation",[]),angular.module("HelpEditorApp",[]),angular.module("helpEditorDirective",[]),angular.module("selectLevelHelp",[]),angular.module("cache",[]),angular.module("file",[]),angular.module("treeresize",[]),angular.module("test",[]),angular.module("guide",[]),angular.module("PlatformsApp",[]),angular.module("accessories",[]);var defaultModules=["ui.bootstrap","ngResource","ngCookies","ngFileUpload","ngRoute","toggle-switch","ngImgCrop","ngTable","user","role","permission","multiSelect","ticket","type","dataOption","nlcFilter","file","xeditable","timer","AppLanguage","TemplateManagerApp","RegionApp","campaignApp","campaignDetailApp","MarketsegmentApp","notification","transApp","assetManager","BlockApp","ChannelPartnersApp","roleGroup1","filedType","filed","term","ui-iconpicker","customFormatDate","SeoAnalysisApp","pageApp","treeresizer","CreatePageApp","EditDraftApp","fomatHtml","colorpicker.module","formBuilderDirectiveApp","appManageTerm","TermTemplateManagerApp","mgo-angular-wizard","configurator","TemplateContentManager","cmsContentFolderApp","lowercaseCharater","selectLevel","configField","cmsContentInsertApp","confirmDirective","CmsApp","checkLimitAndChangeDateTimeDirectiveApp","tagContentApp","tagContentDirective","cmsContentTagApp","viewDraft","modalSelectLevel","databaseManager","selectLevelDatabase","modalSelectPage","configFormDatabaseApp","historyApp","BlockNestedApp","selectLevelAsset","MaterialApp","ui.sortable","activityLog","translation","HelpEditorApp","helpEditorDirective","selectLevelHelp","cache","file","treeresize","guide","PlatformsApp","accessories"];"undefined"!=typeof modules&&(defaultModules=defaultModules.concat(modules));var myApp=angular.module("uls",defaultModules);angular.module("uls").run(["editableOptions",function(e){e.theme="bs3"}]),angular.module("uls").config(["$logProvider",function(e){e.debugEnabled(window.debug)}]),"undefined"!=typeof angularMock&&(defaultModules=defaultModules.concat(angularMock));var goTo=function(e){window.location.href="#_"+e,$("#fix-modal-top").scrollTop(0),$("#"+e).hasClass("in")||$("#"+e).prev().trigger("click")};myApp.config(["$httpProvider",function(e){e.interceptors.push(["$q",function(e){e.defer();return{responseError:function(t){var n=angular.element(".butterbar-container");switch(t.status){case 401:return void(window.location.href=window.baseUrl);case 404:n.hasClass("hidden")&&n.removeClass("hidden");break;case 500:n.hasClass("hidden")&&n.removeClass("hidden")}return e.reject(t)}}}])}]),function(e){function t(){var t=window.innerHeight;screen.height;e(".table-responsive.set-height, .table-responsive#tb-group-user").css({height:t-170+"px"}),e(".table-animate").css({height:t-170+"px"}),e("#search-page,.box-maps").css({height:t-105+"px"}),e(".box-list-rep").css({height:t-100+"px"}),e("#load-maps").css({height:t-185+"px"})}e(document).ready(t),e(window).resize(t),e(document).ready(function(){e(".dropdown-menu table tr td button").removeAttr("style")}),e(document).ready(function(){setTimeout(function(){var t=e("#frame_html").contents().find("head");t.append('<style type="text/css">.area_toolbar{background-color:#f1f1f1;}#editor{border:solid #ccc 1px}#result{border-top:solid #ccc 1px;border-bottom: solid #ccc 1px}.editarea_popup{box-shadow: 0px 4px 36px rgba(177, 177, 177, 0.75);border: solid 1px #CCCCCC;background-color: #FFFFFF;}.area_toolbar select{font-size:9pt;background-color:#fff}</style>')},1e3)}),e(window).load(function(){e(".step3 .show-more").click(function(){e(".step3 .wrap-more-product").toggleClass("show")})}),e(document).ready(function(){e(".nav-icon").click(function(){e(this).toggleClass("open"),e("#pagehome").toggleClass("on-off")})});var n,r,o,a,i,l,d;e(".next").click(function(){return d?!1:(d=!0,n=e(this).parent(),r=e(this).parent().next(),r.show(),void n.animate({opacity:0},{step:function(e,t){l=1-.2*(1-e),a=50*e+"%",i=1-e,n.css({transform:"scale("+l+")"}),r.css({left:a,opacity:i})},duration:800,complete:function(){n.hide(),d=!1},easing:"easeInOutBack"}))}),e(".previous").click(function(){return d?!1:(d=!0,n=e(this).parent(),o=e(this).parent().prev(),o.show(),void n.animate({opacity:0},{step:function(e,t){l=.8+.2*(1-e),a=50*(1-e)+"%",i=1-e,n.css({left:a}),o.css({transform:"scale("+l+")",opacity:i})},duration:800,complete:function(){n.hide(),d=!1},easing:"easeInOutBack"}))}),e(".submit").click(function(){return!1})}(jQuery),angular.module("uls").controller("BaseController",["$scope","$parse","$timeout","$modal","UserService","AssetManagerService",function(e,t,n,r,o,a){if(angular.element(".wrapper").removeClass("hidden"),o.setData(window.usersMap),n(function(){"undefined"!=typeof e.callbackLoadUserFinish&&(e.callbackLoadUserFinish(),e.users_map=o.getUsersMap())}),e.testFuture=window.testFuture,1==e.testFuture&&angular.element(".test").removeClass("hidden"),e.windowType=window.info,"undefined"!=typeof window.info)for(var i in window.info){var l=t(i);l.assign(e,window.info[i])}e.initDate=function(){angular.element(".date").bdatepicker({format:"yyyy-mm-dd"})},e.viewModalImage=function(e){var t=r.open({templateUrl:baseUrl+"/app/components/termTemplateManager/views/modal/viewImage.html",controller:"ModalViewPictureCtrl",size:void 0,windowClass:"show-img",resolve:{fileId:function(){return e}}});t.result.then(function(e){},function(){})},e.urlForm=[],e.getUrlImageAssetForm=function(t,n){"undefined"==typeof e.urlForm[t]&&(e.urlForm[t]=[]),a.getUrlImageAsset(t).then(function(r){e.urlForm[t][n]=r.url})},e.removeThumbnailAssertForm=function(t,n){e.urlForm[t][n]=""},e.initTooltip=function(e){$('[data-toggle="tooltip"]').tooltip()}}]).controller("ModalViewPictureCtrl",["$scope","$modalInstance","fileId",function(e,t,n){e.fileId=n,e.baseUrl=baseUrl,e.cancel=function(){t.dismiss("cancel")}}]);var userModule=angular.module("user");userModule.factory("UserResource",["$resource",function(e){return e("/api/user/:method/:id",{method:"@method",id:"@id"},{add:{method:"post"},save:{method:"post"},update:{method:"put"}})}]).factory("UserService",["$q","$filter","UserResource",function(e,t,n){var r=[],o=[],a=[],i=this,l={},d={};return this.setHashData=function(e){l=e},this.create=function(t){if("undefined"!=typeof t.id)return i.update(t);var o=e.defer(),a=new n(t);return a.$save({},function(e){e.status&&e.item&&(r.push(e.item),"undefined"==typeof e.item.last_login&&(e.item.last_login="0000-00-00 00:00:00")),o.resolve(e)},function(e){o.resolve(e.data)}),o.promise},this.changePassword=function(t){var r=e.defer(),o=new n(t);return o.$save({method:"change-password",id:t.id},function(e){e.status?r.resolve(e):r.reject(e)},function(e){r.reject(e.data)}),r.promise},this.changeRoles=function(t){var r=e.defer(),o=new n(t);return o.$save({method:"change-roles"},function(e){e?r.resolve(e):r.reject(e)},function(e){r.reject(e.data)}),r.promise},this.update=function(t){var o=e.defer(),a=new n(t);return a.$update({id:t.id},function(e){if(e.status)for(var t in r)if(r[t].id==e.item.id){r[t]=e.item;break}o.resolve(e)},function(e){o.resolve(e.data)}),o.promise},this.get=function(t){var r=e.defer();return n.get({id:t},function(e){r.resolve(e)}),r.promise},this.query=function(){var t=e.defer();return n.query(function(e){r=e,t.resolve(e)}),t.promise},this.queryUsersManager=function(){var t=e.defer();return n.query({method:"get-all-user-manager"},function(e){r=e,t.resolve(e)}),t.promise},this.remove=function(t){var o=e.defer();return n["delete"]({id:t},function(e){if(e.status)for(var n in r)if(r[n].id==t){r[n].status="no";break}o.resolve(e)}),o.promise},this.pushUser=function(e){r.push(e)},this.updateUser=function(e){for(var t in r)if(r[t].id==e.id){e.status="yes",r[t]=e;break}},this.changeAvatar=function(t,r){var o=e.defer();return n.save({method:"change-avatar",file:r,id:t},function(e){o.resolve(e)},function(e){o.resolve(e.data)}),o.promise},this.resetPassword=function(t){var r=e.defer();return n.save({method:"email",entity:"password",email:t},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.getUsers=function(){return r},this.getUserById=function(e){return d[e]},this.getUsersMap=function(){return d},this.listMap=function(e,t){if("role"==t)for(var n in e)o[e[n].id]=e[n];else for(var n in e)a[e[n].id]=e[n]},this.getMap=function(e){return"role"==e?o:a},this.userBranchManager=function(t){var r=e.defer();return n.query({id:t,method:"get-users-branch-manager"},function(e){r.resolve(e)}),r.promise},this.updatePermissions=function(t,r){var o=e.defer();return n.save({id:t,permissionIds:r,method:"update-permission"},function(e){o.resolve(e)},function(e){o.resolve(e.data)}),o.promise},this.updateGroup=function(t,r){var o=e.defer();return n.save({id:t,groupIds:r,method:"update-group"},function(e){o.resolve(e)},function(e){o.resolve(e.data)}),o.promise},this.updateRoles=function(t,r){var o=e.defer();return n.save({id:t,roleIds:r,method:"update-role"},function(e){o.resolve(e)},function(e){o.resolve(e.data)}),o.promise},this.changeStatus=function(t){var o=e.defer();return n["delete"]({id:t,method:"change-status"},function(e){if(e.status)for(var n in r)if(r[n].id==t){r[n].status="yes";break}o.resolve(e)}),o.promise},this.setData=function(e){r=e;for(var t in e)d[e[t].id]=e[t];return r},this.updateShowDueDateUser=function(t){var r=e.defer(),o=new n(t);return o.$save({method:"update-show-due-date-user"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this}]);var assetmanagerApp=angular.module("assetManager",["ngResource","ui.bootstrap","ngSanitize","ngTable"]);assetmanagerApp.factory("AssetManagerResource",["$resource",function(e){return e("/api/asset-manager/:method/:id",{method:"@method",id:"@id"},{add:{method:"post"},save:{method:"post"},update:{method:"put"},editNameFolder:{method:"edit-name-folder"}})}]).service("AssetManagerService",["AssetManagerResource","$q",function(e,t){var n=this,r=[];this.createFolderProvider=function(r){if("undefined"!=typeof r.id)return n.editFolderAndFile(r);var o=t.defer(),a=new e(r);return a.$save({method:"create-folder"},function(e){o.resolve(e)},function(e){o.resolve(e.data)}),o.promise},this.uploadNewAsset=function(n){var o=t.defer(),a=new e(n);return a.$save({method:"upload-new-asset"},function(e){0!=e.status&&r.push(e.item),o.resolve(e.item)},function(e){o.resolve(e.data)}),o.promise},this.createNewAsset=function(n){var o=t.defer(),a=new e(n);return a.$save({method:"create-new-asset"},function(e){0!=e.status&&r.push(e.item),o.resolve(e.item)},function(e){o.resolve(e.data)}),o.promise},this.saveFieldFile=function(n){var r=t.defer(),o=new e(n);return o.$save({method:"save-file-asset"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.editFile=function(n){var r=t.defer(),o=new e(n);return o.$save({method:"edit-file"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.crop=function(n){var r=t.defer(),o=new e(n);return o.$save({method:"crop"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.addTagsForPage=function(n,r){var o=t.defer(),a=new e(r);return a.$save({id:n,method:"add-tags"},function(e){0!=e.status,o.resolve(e)},function(e){o.resolve(e.data)}),o.promise},this.getAssetManagerById=function(n){var r=t.defer(),o=new e;return o.$get({id:n},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.setAssetManagers=function(e){return r=e},this.getAssetManagers=function(){return r},this.getUrlImageAsset=function(n){var r=t.defer();return e.get({id:n,method:"get-url-image-asset"},function(e){r.resolve(e)}),r.promise},this.deleteFolderAndAsset=function(n){var r=t.defer(),o=new e;return o.$delete({id:n},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.deleteAssetFile=function(n){var r=t.defer(),o=new e;return o.$get({id:n,method:"delete-file"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.editNameFolder=function(n){var r=t.defer(),o=new e(n);return o.$save({id:n.id,method:"edit-name-folder"},function(e){0!=e.status&&r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.updateContentFile=function(n,r){var o=t.defer(),a=new e(r);return a.$save({id:n,method:"update-content-file"},function(e){o.resolve(e)},function(e){o.resolve(e.data)}),o.promise}}]),angular.module("uls").controller("NotificationController",["$scope","$filter","NotificationService","$controller","$timeout",function(e,t,n,r,o){function a(){}function i(){if(f=!1,c.length>0){var e=c.shift();d(e)}}function l(){}function d(t){if(f)return void c.push(t);if(f=!0,-1==t.data.sender_id)var n=e.baseUrl+"/160x160_avatar_default.png?t=1";else var n=e.users_map[t.data.sender_id].avatar;var r=new Notify("Notification",{icon:n,body:t.data.message,tag:t.data.sender_id,notifyShow:a,notifyClose:i,notifyClick:function(){window.location.href="/"+t.data.href},notifyError:l,timeout:5});r.show()}r("BaseController",{$scope:e}),e.callbackLoadUserFinish=function(){},angular.element("#notification-top").removeClass("hidden"),e.baseUrl=window.baseUrl;var s=10;e.limitTo=s;var u=1;e.notifications=[];var c=[],f=!1;e.amount=0,$(".scroll-noti1").scroll(function(){$(this)[0].scrollHeight-$(this).scrollTop()===$(this).outerHeight()&&e.$apply(function(){e.limitTo=e.limitTo+s})});var p=RowboatPusher.subscribe("notification_ticket");p.bind("Rowboat\\Notification\\Events\\Notifications\\Broadcast\\NotificationTicket",function(t){e.$apply(function(){"undefined"!=typeof t.data.user_id&&-1!=t.data.user_id.indexOf(window.userId)&&(d(t),u=1,e.amount++)})}),e.getNotifications=function(){n.query(u).then(function(t){u&&e.setUserReadThisNotification(),e.notifications=t,e.hightlight=angular.copy(e.amount),e.amount=0,u=0})},e.setUserReadThisNotification=function(){n.setRead().then(function(){})},n.getAmountNotificationsNotRead().then(function(t){e.amount=t.result})}]);var permissionModule=angular.module("notification");permissionModule.factory("NotificationResource",["$resource",function(e){return e("/api/notification/:method/:id",{},{add:{method:"post"},save:{method:"post"}})}]).service("NotificationService",["$q","$filter","NotificationResource",function(e,t,n){var r=[];this.getAmountNotificationsNotRead=function(t){var r=e.defer();return n.get({method:"amount-notifications-not-read"},function(e){r.resolve(e)}),r.promise},this.query=function(t){var o=e.defer();return t?n.query().$promise.then(function(e){r=e,o.resolve(r)}):o.resolve(r),o.promise},this.notificationInvite=function(t){var r=e.defer(),o=new n(t);return o.$save({data:t,method:"invite"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.setRead=function(){var t=e.defer(),r=new n;return r.$save({method:"set-read"},function(e){t.resolve(e)},function(e){t.resolve(e.data)}),t.promise}}]),notificationModule=angular.module("notification"),notificationModule.directive("notification",[function(){return{restrict:"AE",scope:{item:"="},replace:!0,templateUrl:baseUrl+"/app/shared/notification/views/notification.html",link:function(){}}}]);var module=angular.module("uls");module.directive("rowboatRequired",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){"undefined"==typeof e.$eval(n.ngModel)&&r.$setValidity("rowboatRequired",!1),t.on("focus",function(o){e.$watch(n.ngModel,function(e){var n="undefined"!=typeof e&&0!=e.length;if(n)t.parent().find("span").remove(),t.parent().removeClass("error"),r.$setValidity("rowboatRequired",n);else if(0==t.parent().find("span").length){t.parent().addClass("error");var o='<span class="control-label">It is required</span>';t.parent().append(o),r.$setValidity("rowboatRequired",n)}})})}}}),module.directive("rowboatLength",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){"undefined"!=typeof e.$eval(n.ngModel)&&e.$eval(n.ngModel).length!=n.rowboatLength&&r.$setValidity("rowboatLength",!1),t.on("focus",function(o){e.$watch(n.ngModel,function(e){var o=n.rowboatLength,a="undefined"!=typeof e&&e.length==o;if(a)t.parent().find("span").remove(),t.parent().removeClass("error"),r.$setValidity("rowboatLength",a);else if(0==t.parent().find("span").length){t.parent().addClass("error");var i='<span class="control-label">Length is '+o+"</span>";t.parent().append(i),r.$setValidity("rowboatLength",a)}})})}}}),module.directive("rowboatMinLength",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){"undefined"!=typeof e.$eval(n.ngModel)&&e.$eval(n.ngModel).length<n.rowboatMinLength&&r.$setValidity("rowboatMinLength",!1),t.on("focus",function(o){e.$watch(n.ngModel,function(e){var o=n.rowboatMinLength,a="undefined"!=typeof e&&e.length>=o;if(a)t.parent().find("span").remove(),t.parent().removeClass("error"),r.$setValidity("rowboatMinLength",a);else if(0==t.parent().find("span").length){t.parent().addClass("error");var i='<span class="control-label">Min length is '+o+"</span>";t.parent().append(i),r.$setValidity("rowboatMinLength",a)}})})}}}),module.directive("rowboatMaxLength",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){"undefined"!=typeof e.$eval(n.ngModel)&&e.$eval(n.ngModel).length>n.rowboatMaxLength&&r.$setValidity("rowboatMaxLength",!1),t.on("focus",function(o){e.$watch(n.ngModel,function(e){var o=n.rowboatMaxLength,a="undefined"!=typeof e&&e.length<=o;if(a)t.parent().find("span").remove(),t.parent().removeClass("error"),r.$setValidity("rowboatMaxLength",a);else if(0==t.parent().find("span").length){t.parent().addClass("error");var i='<span class="control-label">Max length is '+o+"</span>";t.parent().append(i),r.$setValidity("rowboatMaxLength",a)}})})}}}),module.directive("rowboatEmailPattern",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){$pattern=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/,"undefined"==typeof e.$eval(n.ngModel)&&r.$setValidity("rowboatEmailPattern",!1),t.on("blur",function(o){e.$watch(n.ngModel,function(e){var n="undefined"!=typeof e&&$pattern.test(e);if(n)t.parent().find("span").remove(),t.parent().removeClass("error"),r.$setValidity("rowboatEmailPattern",n);else if(0==t.parent().find("span").length){t.parent().addClass("error");var o='<span class="control-label">Email Invalid</span>';t.parent().append(o),r.$setValidity("rowboatEmailPattern",n)}})})}}});var filterDate=angular.module("customFormatDate",[]);filterDate.filter("myDate",["$filter",function(e){return function(t,n){if(null==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var r=e("date")(new Date(String(t)),angular.isUndefined(n)?"MM-dd-yyyy":n);return String(r)}}]).filter("myDateL",["$filter",function(e){return function(t){if(null==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var n=e("date")(new Date(String(t)),"MMMM d, y");return String(n)}}]).filter("myDateTime",["$filter",function(e){return function(t){if(null==t)return"";if("0000-00-00 00:00:00"==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var n=e("date")(new Date(String(t)),"MM-dd-yyyy HH:mm:ss");return String(n)}}]).filter("myDateShortTime",["$filter",function(e){return function(t){if(null==t)return"";if("0000-00-00 00:00:00"==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var n=e("date")(new Date(String(t)),"MM-dd-yyyy h:mma");return String(n)}}]).filter("clientDate",["$filter",function(e){return function(t,n){if(null==t)return"";if("0000-00-00 00:00:00"==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";t=new Date(t),t=new Date(parseInt(new Date(t).getTime())-60*parseInt((new Date).getTimezoneOffset())*1e3);var r=e("date")(new Date(String(t)),angular.isUndefined(n)?"MM-dd-yyyy":n);return String(r)}}]).filter("clientDateTime",["$filter",function(e){return function(t){return e("date")(checkInvalid(t),window.dateTimeFormat)}}]).filter("clientLogDate",["$filter",function(e){return function(t){return e("date")(checkInvalid(t),window.logDate)}}]).filter("clientMediumDate",["$filter",function(e){return function(t){return e("date")(checkInvalid(t),window.mediumDate)}}]).filter("clientShortTime",["$filter",function(e){return function(t){return e("date")(checkInvalid(t),window.shortTime)}}]).filter("clientShortTimeFollowTimezone",["$filter",function(e){return function(t,n){if(null==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var r=e("date")(new Date(String(t)),window.shortTime);return String(r)}}]).filter("formatCurrentDate",["$filter",function(e){return function(e){if(e=checkInvalid(e),!e)return"";e=new Date(e);var t=e.getMonth()+"-"+e.getDate()+"-"+e.getFullYear();return String(t)}}]).filter("formatCurrentTime",["$filter",function(e){return function(e){if(e=checkInvalid(e),!e)return"";e=new Date(e);var t=e.getHours()>=12?"pm":"am",n=parseInt(e.getHours())%12;n=n?10>n?"0"+n:n:12;var r=parseInt(e.getMinutes())<10?"0"+e.getMinutes():e.getMinutes(),o=parseInt(e.getSeconds())<10?"0"+e.getSeconds():e.getSeconds(),a=n+"-"+r+"-"+o+" "+t;return String(a)}}]).filter("formatCurrentShortTime",["$filter",function(e){return function(e){if(e=checkInvalid(e),!e)return"";e=new Date(e);var t=e.getHours()>=12?"pm":"am",n=parseInt(e.getHours())%12;n=n?10>n?"0"+n:n:12;var r=parseInt(e.getMinutes())<10?"0"+e.getMinutes():e.getMinutes(),o=n+":"+r+" "+t;return String(o)}}]);var checkInvalid=function(e,t){if(null==e)return"";if("Invalid Date"==new Date(e))for(;-1!=String(e).indexOf("-");)e=e.replace("-","/");return"Invalid Date"==new Date(e)?"":(e=new Date(e),e=new Date(parseInt(new Date(e).getTime())-60*parseInt((new Date).getTimezoneOffset())*1e3),new Date(String(e)))};angular.module("nlcFilter").filter("elapsedtime",function(){return function(e){return humanized_time_span(e)}});var translation=angular.module("translation",[]);translation.filter("trans",["$filter",function(e){return function(e,t){return null==e?"":window.translations[t][e]}}]);var selectLevel=angular.module("helpEditorDirective",[]),version=5;selectLevel.directive("helpEditorDirective",["$timeout","$filter",function(e,t){return{require:"?ngModel",restrict:"EA",scope:{items:"=",text:"@",selectedItems:"=selectedItem",onClick:"&"},replace:!0,templateUrl:baseUrl+"/app/components/user/help-editor/view/view-help.html?v="+(new Date).getTime(),link:function(t,n,r,o){t.description="",t.recursiveGetDescription=function(e){angular.forEach(e,function(e,n){e.parent=!1,t.description+='<strong class="space-topic" id="_'+e._id+'">'+e.name+"</strong>"+e.description,e.subFolder.length>0&&t.recursiveGetDescription(e.subFolder)})},t.getDesctiption=function(){angular.forEach(t.items,function(e,n){e.parent=!0,t.description+='<h4 id="_'+e._id+'" class="c-primary">'+e.name+'</h4><div class="space-area user-ad-area">'+e.description,t.recursiveGetDescription(e.subFolder),t.description+="</div>"})},t.getDesctiption(),t.goToAnchorWithId=function(e){window.location.href="#"+e,$("#fix-modal-top").scrollTop(0)},e(function(){$(".sub-select-"+t.items[0]._id).addClass("in")})}}}]);var helpEditorApp=angular.module("HelpEditorApp");helpEditorApp.factory("HelpEditorResource",["$resource",function(e){return e("/api/help-editor/:method/:_id",{method:"@method",_id:"@_id"},{add:{method:"post"},save:{method:"post"},update:{method:"put"},editNameFolder:{method:"edit-name-folder"}})}]).service("HelpEditorService",["HelpEditorResource","$q",function(e,t){this.createHelpEditor=function(n){if(angular.isDefined(n._id))return this.updateHelpEditor(n);var r=t.defer(),o=new e(n);return o.$save({},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.createNewTopic=function(n){if(angular.isDefined(n._id))return this.updateHelpEditor(n);var r=t.defer(),o=new e(n);return o.$save({method:"create-new-topic"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.updateHelpEditor=function(n){var r=t.defer(),o=new e(n);return o.$update({},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.deleteHelpEditor=function(n){var r=t.defer();data={_id:n};var o=new e(data);return o.$delete({},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.getListHelpEditorWithParentIdZero=function(){var n=t.defer(),r=new e;return r.$save({method:"get-list-help-editor-with-parent-id-zero"},function(e){n.resolve(e)},function(e){n.resolve(e.data)}),n.promise},this.addPage=function(n){var r=t.defer(),o=new e(n);return o.$save({method:"add-page"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.updateSortNumber=function(n){var r=t.defer(),o=new e(n);return o.$save({method:"update-sort-number"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise}}]);var helpEditorApp=angular.module("HelpEditorApp");helpEditorApp.controller("HelpEditorController",["$scope","$modal","ngTableParams","$timeout","HelpEditorService","$filter",function(e,t,n,r,o,a){function i(e){o.getListHelpEditorWithParentIdZero().then(function(t){e.call(!0,t.data)})}e.helpEditors=angular.copy(window.folders),e.rootHelps=angular.copy(e.helpEditors),angular.forEach(e.helpEditors,function(e,t){e.children.sort(function(e,t){return e.sort_number-t.sort_number})}),e.currentIdNodeAcive=0,e.initTree=function(){$("#tree").fancytree({extensions:["glyph","dnd"],source:e.helpEditors,autoScroll:!0,dnd:{autoExpandMS:400,focusOnClick:!0,preventVoidMoves:!0,preventRecursiveMoves:!0,dragStart:function(e,t){return!e.isFolder()&&"0"!=e.data.parent_id},dragEnter:function(e,t){return e.parent===t.otherNode.parent},dragDrop:function(t,n){if("over"!=n.hitMode){$("#page-loading").css("display","block"),n.otherNode.moveTo(t,n.hitMode);var r=e.tree.getNodeByKey(n.node.data.parent_id);e.data=[],angular.forEach(r.children,function(t,n){e.data.push(t.data)}),o.updateSortNumber(e.data).then(function(e){e.status&&$("#page-loading").css("display","none")})}}},beforeActivate:function(t,n){if(0==e.saved){if("0"==e.activeNode.data.parent_id)var r="You have not saved the changes to the current page";else var r="You have not saved the changes to the current topic";return alert(r),!1}},activate:function(t,n){e.success=!1,e.saved=!0,n.node.setExpanded(!0),"undefined"!=typeof n&&"undefined"!=typeof n.node&&"undefined"!=typeof n.node.key&&"undefined"!=typeof n.node.data&&"0"==n.node.data.parent_id&&(e.currentIdNodeAcive=n.node.key),e.isShowPage=!1,e.isShowTopic=!1,e.isChangeParent=!1,e.helpEditor=n.node.data,e.activeNode=n.node,angular.isDefined(e.activeNode)&&(e.showEditor=!0),r(function(){$("#description").redactor("code.set",n.node.data.description),$("#description").val(n.node.data.description)})},click:function(e,t){t.node.folder||t.node.toggleExpanded()}}),e.tree=$("#tree").fancytree("getTree"),nodeFirst=e.tree.getFirstChild(),angular.isDefined(nodeFirst)&&nodeFirst.setActive()},e.changePageType=function(){e.isChangeParent=!0,e.setIsNotSaved()},e.updateHelp=function(){$("#page-loading").css("display","block"),e.helpEditor.description=$("#description").redactor("code.get"),e.helpEditor.title=e.helpEditor.name,e.oldParentNode=e.activeNode.getParent(),o.updateHelpEditor(e.helpEditor).then(function(t){if(t.status){if(e.rootHelps=t.rootHelps,e.saved=!0,e.activeNode.setTitle(e.helpEditor.title),e.isChangeParent){var n=e.tree.getNodeByKey(String(e.helpEditor.parent_id));e.activeNode.moveTo(n),n.setActive(),n.folder=!0,n.render(),e.setOldParentIsFolder()}e.success=!0,r(function(){e.success=!1},3e3),window.folders=t.folders}else e.errorMessage=t.errors.title[0],r(function(){e.errorMessage=!1},3e3);$("#page-loading").css("display","none")}).then(function(){$("#page-loading").css("display","none")})},e.setOldParentIsFolder=function(){null==e.oldParentNode.children&&(e.oldParentNode.folder=!1,e.oldParentNode.render())},e.editDetail=function(){"0"==e.activeNode.data.parent_id?e.isShowPage=!0:e.isShowTopic=!0},e.createHelpEditor=function(t){return e.submitted=!0,e.saving=!0,e.error=!1,e.errors=[],$content=$("#description").redactor("code.get"),e.isRequiredRedactor=!1,""!=$content&&"<div></div>"!=$content&&"<br>"!=$content||(e.isRequiredRedactor=!0),t||e.isRequiredRedactor?void(e.saving=!1):(e.helpEditor.description=$content,angular.isUndefined(e.helpEditor.parent_id)&&(e.helpEditor.parent_id="0"),void o.createHelpEditor(e.helpEditor).then(function(t){t.status?window.location=window.baseUrl+"/admin/help-editor":(e.error=!0,
e.saving=!1,e.errors=t.errors)}))},e.initRedactor=function(t){$("#description").redactor({imageUpload:window.baseUrl+"/file-redactor/upload-file-redactor",plugins:["table",1==window.isAdvancedEditingFeatures?"source":"","linkPageTopic"],callbacks:{modalOpened:function(e,t){if("link"!=e||this.observe.isCurrent("a")){if("link"==e){var n=this.link.$node.attr("rel");"undefined"==typeof n?$('<label><input type="checkbox" id="redactor-link-no-follow"> No Follow</label>').insertAfter($("#redactor-link-blank").parent()):$('<label><input type="checkbox" checked id="redactor-link-no-follow"> No Follow</label>').insertAfter($("#redactor-link-blank").parent())}}else $("#redactor-link-blank").attr("checked","true"),$('<label><input type="checkbox" checked id="redactor-link-no-follow"> No Follow</label>').insertAfter($("#redactor-link-blank").parent())},insertedLink:function(e){$(e).attr("href");$("#redactor-link-no-follow").prop("checked")?e.attr("rel","nofollow"):e.removeAttr("rel")},linkify:function(e){e.attr("target","_blank")},change:function(){e.setIsNotSaved(),$content=$("#"+t).redactor("code.get"),e.$apply(function(){"<div></div>"==$content||""==$content||"<br>"==$content?(e.saved=!0,e.isRequiredRedactor=!1):e.isRequiredRedactor=!0})}},linkSize:1e3,minHeight:300}),r(function(){"undefined"!=typeof e.helpEditor&&angular.isDefined(e.helpEditor._id)&&$("#description").redactor("code.set",e.helpEditor.description)})},e.createNewHelp=function(){var e=$("#tree").fancytree("getTree"),t=e.getActiveNode(),n="0";null!=t?(n=t.data._id,window.location.href=window.baseUrl+"/admin/help-editor/create?selectedItemId="+n+"&&v="+(new Date).getTime()):window.location.href=window.baseUrl+"/admin/help-editor/create"},e.deleteHelpEditor=function(){if("undefined"!=typeof e.activeNode&&"undefined"!=typeof e.activeNode.data&&"undefined"!=typeof e.activeNode.data.parent_id&&"0"!=e.activeNode.data.parent_id)var t=confirm("The topic will be deleted, and we will lose all data in the topic.");else var t=confirm("The page will be deleted, and they will lose all data in the page.");t&&($("#page-loading").css("display","block"),o.deleteHelpEditor(e.activeNode.data._id).then(function(t){if(e.error=!1,t.status){e.saved=!0;var n=$("#tree").fancytree("getTree"),r=n.getNodeByKey(String(e.activeNode.data._id)),o=r.getParent();if(r.remove(),"0"==e.activeNode.data.parent_id){var a=n.getRootNode();o=a.getFirstChild()}o.hasChildren()||(o.folder=!1),o.setActive(event,o),o.render()}else e.error=!0;$("#page-loading").css("display","none")}).then(function(){$("#page-loading").css("display","none")}))},e.showModelCreateTopic=function(){if(0==e.saved){if("0"==e.activeNode.data.parent_id)var n="You have not saved the changes to the current page";else var n="You have not saved the changes to the current topic";return alert(n),!1}e.saved=!0,i(function(n){if(n.length||Object.keys(n).length){var r="/admin/help-editor/get-model-create-topic?v="+(new Date).getTime(),o=t.open({templateUrl:window.baseUrl+r,controller:"ModelCreateTopic",size:void 0,resolve:{listItemHelpEditor:function(){return n},parentId:function(){return e.currentIdNodeAcive}}});o.result.then(function(e){window.folders=e.folders;var t=e.result;t.key=t._id,t.name=t.title;var n=$("#tree").fancytree("getTree"),r=n.getNodeByKey(t.parent_id);r.folder=!0;var o=r.addNode(t);r.render(),o.setActive()})}})},e.addPage=function(){if(0==e.saved){if("0"==e.activeNode.data.parent_id)var n="You have not saved the changes to the current page";else var n="You have not saved the changes to the current topic";return alert(n),!1}e.saved=!0;var r="/admin/help-editor/add-page",o=t.open({animation:!0,templateUrl:window.baseUrl+r,controller:"AddPageController",size:null,resolve:{}});o.result.then(function(t){t.children=[],window.folders.push(t),t.name=t.title,t.key=t._id;var n=$("#tree").fancytree("getTree"),r=n.getRootNode();nodeAdd=r.addChildren(t),nodeAdd.setActive(),e.rootHelps.push(t)},function(){})},e.setIsNotSaved=function(){e.saved=!1}}]),helpEditorApp.controller("AddPageController",["$scope","$modalInstance","HelpEditorService",function(e,t,n){e.addPage=function(r){e.submitted=!0,r||(e.saving=!0,n.addPage(e.help).then(function(n){-1==n.status?(e.error=!0,e.saving=!1,e.errors=n.errors):n.status?t.close(n.help):(e.error=!0,e.saving=!1,e.errors=n.errors)}))},e.cancel=function(){t.dismiss("cancel")}}]);var selectLevelHelp=angular.module("selectLevelHelp",[]),version=5;selectLevelHelp.directive("selectLevelHelp",["$timeout","$filter",function(e,t){return{require:"?ngModel",restrict:"EA",scope:{items:"=",text:"@",title:"@",textFilter:"@",index:"=",key:"=",itemChoose:"=",selectedItems:"=selectedItem",onClick:"&",currentPage:"=",showIcon:"=",typeSelect:"=",disableClick:"=",notSelectCurrent:"=",chageType:"=",type:"="},replace:!0,templateUrl:baseUrl+"/app/components/user/help-editor/view/view.html?v="+(new Date).getTime(),link:function(t,n,r,o){t.$watch("selectedItems",function(n,r){angular.isDefined(n)&&null!=n&&e(function(){var e={_id:n.selectedItemId,name:n.selectedItemName,ancestor_ids:n.ancestor_ids};t.selectedItem(e)})});var a="";"undefined"==typeof t.index&&(t.index=0),"undefined"==typeof t.key&&(t.key=0),e(function(){$(document).on("click",function(e){$("#select-level-modal-"+t.key+"-"+t.index).hasClass("in")&&!$(".js-filterable-field").is(":focus")&&($("#select-level-modal-"+t.key+"-"+t.index).collapse("hide"),$(".show-sub-select i").removeClass("fa fa-folder-open fa").addClass("fa fa-folder"))}),$("#select-level li:has(ul)").children("ul").addClass("off"),$("#select-level li a i").addClass("fa fa-folder"),t.listsId=[],t.showSubSelect=function(e,t){e.preventDefault(),$(e.currentTarget).parent().find("ul:first").toggleClass("off"),$(e.currentTarget).find("i").addClass("fa fa-folder"),$(e.currentTarget).find("i").toggleClass("fa fa-folder-open fa"),e.stopPropagation()},"undefined"!=typeof t.itemChoose&&i(t.items)}),t.focusInput=function(e){e.stopPropagation()},t.selectedItem=function(e,n){t.text=e.name,o.$setViewValue(e._id),t.chageType&&t.onClick({pageId:e._id}),$("#select-level-modal-"+t.key+"-"+t.index).find(".name-select.active").removeClass("active"),a=e,$("#select-level-modal-"+t.key+"-"+t.index).find(".item-"+a._id).addClass("active"),angular.isDefined(n)&&$("#select-level-modal-"+t.key+"-"+t.index).collapse("hide")},t.toggleSelectMenu=function(n){e(function(){t.itemsTmp=t.items}),e(function(){$(".show-sub-select").removeClass("active"),$("#select-level li a i").removeClass("fa fa-folder-open fa").addClass("fa fa-folder"),$(".parrent-select").addClass("off"),a&&(angular.forEach($(".item-"+a._id).parents("ul"),function(e,t){$(e).removeClass("off")}),$(".show-sub-select-"+a._id).addClass("active"),angular.forEach(a.ancestor_ids,function(e,t){a._id!=e&&$(".show-sub-select-"+e).find("i").removeClass("fa fa-folder").addClass("fa fa-folder-open fa")})),$("#select-level-modal-"+t.key+"-"+t.index).collapse("toggle")})},t.closed=function(e){$("#select-level-modal-"+t.key+"-"+t.index).collapse("hide")};var i=function(e){for(var n in e)if(e[n].subFolder&&i(e[n].subFolder),e[n]._id==t.itemChoose){t.text=e[n].name;break}}}}}]);