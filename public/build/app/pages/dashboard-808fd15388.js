function humanized_time_span(e,t,n,a){function r(){for(var e=0;e<n[u].length;e++)if(null==n[u][e].ceiling||l<=n[u][e].ceiling)return n[u][e];return null}function i(){for(var e=l,t={},n=0;n<a.length;n++){var r=Math.floor(e/a[n][0]);e-=a[n][0]*r,t[a[n][1]]=r}return t}function o(e){var t=i(),n=e.text.replace(/\$(\w+)/g,function(){return t[arguments[1]]});return s(n,t)}function s(e,t){for(var n in t)if(1==t[n]){var a=new RegExp("\\b"+n+"\\b");e=e.replace(a,function(){return arguments[0].replace(/s\b/g,"")})}return e}if(n=n||{past:[{ceiling:60,text:"$seconds seconds ago"},{ceiling:3600,text:"$minutes minutes ago"},{ceiling:86400,text:"$hours hours ago"},{ceiling:2629744,text:"$days days ago"},{ceiling:31556926,text:"$months months ago"},{ceiling:null,text:"$years years ago"}],future:[{ceiling:60,text:"in $seconds seconds"},{ceiling:3600,text:"in $minutes minutes"},{ceiling:86400,text:"in $hours hours"},{ceiling:2629744,text:"in $days days"},{ceiling:31556926,text:"in $months months"},{ceiling:null,text:"in $years years"}]},a=a||[[31556926,"years"],[2629744,"months"],[86400,"days"],[3600,"hours"],[60,"minutes"],[1,"seconds"]],"Invalid Date"==new Date(e))for(;-1!=String(e).indexOf("-");)e=e.replace("-","/");e=new Date(e),t=t?new Date(t):new Date;var l=(t-e)/1e3,u="past";return 0>l&&(u="future",l=0-l),o(r())}function drawPageStatusChart(){function e(e){var n=t.getValue(a.getSelection()[0].row,0);"Ready for Review"==n&&(n="reviewed");var r=window.baseUrl+"/pages/click-status";$.ajax({url:r,type:"GET",cache:!1,data:{status:n},success:function(e){e.status&&(window.location.href=window.baseUrl+"/cms/pages")}})}var t=new google.visualization.DataTable;t.addColumn("string","Topping"),t.addColumn("number","Slices"),t.addRows([["Live",window.pageOverview.pageStatus.live],["Approved",window.pageOverview.pageStatus.approved],["Ready for Review",window.pageOverview.pageStatus.reviewed],["In Process",window.pageOverview.pageStatus.inProcess],["Not Started",window.pageOverview.pageStatus.notStarted]]);var n={title:"Page Status",pieHole:.4,width:400,height:300,pieSliceTextStyle:{color:"#000"},sliceVisibilityThreshold:0,slices:{0:{color:"#2CEA2C"},1:{color:"#346EDE"},2:{color:"#85ce1d"},3:{color:"#7435C5"},4:{color:"#FF0"}}},a=new google.visualization.PieChart(document.getElementById("PageStatusChart"));a.draw(t,n),google.visualization.events.addListener(a,"select",e)}function drawPageUpdatesChart(){function e(e){var t=window.baseUrl+"/pages/click-last-update";$.ajax({url:t,type:"GET",cache:!1,data:{lastUpDate:!0},success:function(e){e.status&&(window.location.href=window.baseUrl+"/cms/pages")}})}var t=new google.visualization.DataTable;t.addColumn("string","Topping"),t.addColumn("number","Slices"),t.addRows(window.pageOverview.pageUpdate);var n={title:"Page Updates",pieHole:.4,width:400,height:300,sliceVisibilityThreshold:0,pieSliceTextStyle:{color:"#000"}},a=new google.visualization.PieChart(document.getElementById("PageUpdateChart"));a.draw(t,n),google.visualization.events.addListener(a,"select",e)}function drawLanguageChart(){var e=new google.visualization.DataTable;e.addColumn("string","Topping"),e.addColumn("number","Slices"),e.addRows(window.pageOverview.pageLanguage);var t={title:"Languages",pieHole:.4,width:400,height:300,sliceVisibilityThreshold:0,pieSliceTextStyle:{color:"#000"}},n=new google.visualization.PieChart(document.getElementById("PageLanguageChart"));n.draw(e,t)}function drawVisitorsChart(){var e=new google.visualization.DataTable;e.addColumn("string","Topping"),e.addColumn("number","Slices"),e.addRows([["Passed",1],["Not run",1],["Failed",2]]);var t={title:"Visitors Last 24 Hours",pieHole:.4,width:400,height:300,pieSliceTextStyle:{color:"#000"}},n=new google.visualization.PieChart(document.getElementById("PageVisitorsChart"));n.draw(e,t)}function drawCollumnVisitorsandLeads(){var e=new google.visualization.arrayToDataTable([["Visitors & Leads Last 7 Days","Distance","Brightness"],["January",8e3,23.3],["February",24e3,4.5],["March",3e4,14.3],["April",5e4,.9],["May",6e4,13.1]]),t={width:900,series:{0:{axis:"distance"},1:{axis:"brightness"}},axes:{y:{}}},n=new google.charts.Bar(document.getElementById("CollumnVisitorsandLeads"));n.draw(e,t)}angular.module("user",[]),angular.module("permission",[]),angular.module("role",[]),angular.module("multiSelect",[]),angular.module("ticket",[]),angular.module("type",[]),angular.module("dataOption",[]),angular.module("nlcFilter",[]),angular.module("file",[]),angular.module("AppLanguage",[]),angular.module("TemplateManagerApp",[]),angular.module("RegionApp",[]),angular.module("campaignApp",[]),angular.module("campaignDetailApp",[]),angular.module("MarketsegmentApp",[]),angular.module("notification",[]),angular.module("transApp",[]),angular.module("assetManager",[]),angular.module("BlockApp",[]),angular.module("ChannelPartnersApp",[]),angular.module("roleGroup1",[]),angular.module("filedType",[]),angular.module("filed",[]),angular.module("term",[]),angular.module("customFormatDate",[]),angular.module("SeoAnalysisApp",[]),angular.module("pageApp",[]),angular.module("treeresizer",[]),angular.module("CreatePageApp",[]),angular.module("EditDraftApp",[]),angular.module("fomatHtml",[]),angular.module("colorpicker.module",[]),angular.module("formBuilderDirectiveApp",[]),angular.module("appManageTerm",[]),angular.module("TermTemplateManagerApp",[]),angular.module("configurator",[]),angular.module("TemplateContentManager",[]),angular.module("cmsContentFolderApp",[]),angular.module("lowercaseCharater",[]),angular.module("selectLevel",[]),angular.module("modalSelectLevel",[]),angular.module("configField",[]),angular.module("cmsContentInsertApp",[]),angular.module("confirmDirective",[]),angular.module("CmsApp",[]),angular.module("checkLimitAndChangeDateTimeDirectiveApp",[]),angular.module("tagContentApp",[]),angular.module("tagContentDirective",[]),angular.module("cmsContentTagApp",[]),angular.module("viewDraft",[]),angular.module("databaseManager",[]),angular.module("selectLevelDatabase",[]),angular.module("modalSelectPage",[]),angular.module("configFormDatabaseApp",[]),angular.module("historyApp",[]),angular.module("BlockNestedApp",[]),angular.module("selectLevelAsset",[]),angular.module("MaterialApp",[]),angular.module("draganddrop",[]),angular.module("activityLog",[]),angular.module("translation",[]),angular.module("HelpEditorApp",[]),angular.module("helpEditorDirective",[]),angular.module("selectLevelHelp",[]),angular.module("cache",[]),angular.module("file",[]),angular.module("treeresize",[]),angular.module("test",[]),angular.module("guide",[]),angular.module("PlatformsApp",[]),angular.module("accessories",[]);var defaultModules=["ui.bootstrap","ngResource","ngCookies","ngFileUpload","ngRoute","toggle-switch","ngImgCrop","ngTable","user","role","permission","multiSelect","ticket","type","dataOption","nlcFilter","file","xeditable","timer","AppLanguage","TemplateManagerApp","RegionApp","campaignApp","campaignDetailApp","MarketsegmentApp","notification","transApp","assetManager","BlockApp","ChannelPartnersApp","roleGroup1","filedType","filed","term","ui-iconpicker","customFormatDate","SeoAnalysisApp","pageApp","treeresizer","CreatePageApp","EditDraftApp","fomatHtml","colorpicker.module","formBuilderDirectiveApp","appManageTerm","TermTemplateManagerApp","mgo-angular-wizard","configurator","TemplateContentManager","cmsContentFolderApp","lowercaseCharater","selectLevel","configField","cmsContentInsertApp","confirmDirective","CmsApp","checkLimitAndChangeDateTimeDirectiveApp","tagContentApp","tagContentDirective","cmsContentTagApp","viewDraft","modalSelectLevel","databaseManager","selectLevelDatabase","modalSelectPage","configFormDatabaseApp","historyApp","BlockNestedApp","selectLevelAsset","MaterialApp","ui.sortable","activityLog","translation","HelpEditorApp","helpEditorDirective","selectLevelHelp","cache","file","treeresize","guide","PlatformsApp","accessories"];"undefined"!=typeof modules&&(defaultModules=defaultModules.concat(modules));var myApp=angular.module("uls",defaultModules);angular.module("uls").run(["editableOptions",function(e){e.theme="bs3"}]),angular.module("uls").config(["$logProvider",function(e){e.debugEnabled(window.debug)}]),"undefined"!=typeof angularMock&&(defaultModules=defaultModules.concat(angularMock));var goTo=function(e){window.location.href="#_"+e,$("#fix-modal-top").scrollTop(0),$("#"+e).hasClass("in")||$("#"+e).prev().trigger("click")};myApp.config(["$httpProvider",function(e){e.interceptors.push(["$q",function(e){e.defer();return{responseError:function(t){var n=angular.element(".butterbar-container");switch(t.status){case 401:return void(window.location.href=window.baseUrl);case 404:n.hasClass("hidden")&&n.removeClass("hidden");break;case 500:n.hasClass("hidden")&&n.removeClass("hidden")}return e.reject(t)}}}])}]),function(e){function t(){var t=window.innerHeight;screen.height;e(".table-responsive.set-height, .table-responsive#tb-group-user").css({height:t-170+"px"}),e(".table-animate").css({height:t-170+"px"}),e("#search-page,.box-maps").css({height:t-105+"px"}),e(".box-list-rep").css({height:t-100+"px"}),e("#load-maps").css({height:t-185+"px"})}e(document).ready(t),e(window).resize(t),e(document).ready(function(){e(".dropdown-menu table tr td button").removeAttr("style")}),e(document).ready(function(){setTimeout(function(){var t=e("#frame_html").contents().find("head");t.append('<style type="text/css">.area_toolbar{background-color:#f1f1f1;}#editor{border:solid #ccc 1px}#result{border-top:solid #ccc 1px;border-bottom: solid #ccc 1px}.editarea_popup{box-shadow: 0px 4px 36px rgba(177, 177, 177, 0.75);border: solid 1px #CCCCCC;background-color: #FFFFFF;}.area_toolbar select{font-size:9pt;background-color:#fff}</style>')},1e3)}),e(window).load(function(){e(".step3 .show-more").click(function(){e(".step3 .wrap-more-product").toggleClass("show")})}),e(document).ready(function(){e(".nav-icon").click(function(){e(this).toggleClass("open"),e("#pagehome").toggleClass("on-off")})});var n,a,r,i,o,s,l;e(".next").click(function(){return l?!1:(l=!0,n=e(this).parent(),a=e(this).parent().next(),a.show(),void n.animate({opacity:0},{step:function(e,t){s=1-.2*(1-e),i=50*e+"%",o=1-e,n.css({transform:"scale("+s+")"}),a.css({left:i,opacity:o})},duration:800,complete:function(){n.hide(),l=!1},easing:"easeInOutBack"}))}),e(".previous").click(function(){return l?!1:(l=!0,n=e(this).parent(),r=e(this).parent().prev(),r.show(),void n.animate({opacity:0},{step:function(e,t){s=.8+.2*(1-e),i=50*(1-e)+"%",o=1-e,n.css({left:i}),r.css({transform:"scale("+s+")",opacity:o})},duration:800,complete:function(){n.hide(),l=!1},easing:"easeInOutBack"}))}),e(".submit").click(function(){return!1})}(jQuery),angular.module("uls").controller("BaseController",["$scope","$parse","$timeout","$modal","UserService","AssetManagerService",function(e,t,n,a,r,i){if(angular.element(".wrapper").removeClass("hidden"),r.setData(window.usersMap),n(function(){"undefined"!=typeof e.callbackLoadUserFinish&&(e.callbackLoadUserFinish(),e.users_map=r.getUsersMap())}),e.testFuture=window.testFuture,1==e.testFuture&&angular.element(".test").removeClass("hidden"),e.windowType=window.info,"undefined"!=typeof window.info)for(var o in window.info){var s=t(o);s.assign(e,window.info[o])}e.initDate=function(){angular.element(".date").bdatepicker({format:"yyyy-mm-dd"})},e.viewModalImage=function(e){var t=a.open({templateUrl:baseUrl+"/app/components/termTemplateManager/views/modal/viewImage.html",controller:"ModalViewPictureCtrl",size:void 0,windowClass:"show-img",resolve:{fileId:function(){return e}}});t.result.then(function(e){},function(){})},e.urlForm=[],e.getUrlImageAssetForm=function(t,n){"undefined"==typeof e.urlForm[t]&&(e.urlForm[t]=[]),i.getUrlImageAsset(t).then(function(a){e.urlForm[t][n]=a.url})},e.removeThumbnailAssertForm=function(t,n){e.urlForm[t][n]=""},e.initTooltip=function(e){$('[data-toggle="tooltip"]').tooltip()}}]).controller("ModalViewPictureCtrl",["$scope","$modalInstance","fileId",function(e,t,n){e.fileId=n,e.baseUrl=baseUrl,e.cancel=function(){t.dismiss("cancel")}}]);var userModule=angular.module("user");userModule.factory("UserResource",["$resource",function(e){return e("/api/user/:method/:id",{method:"@method",id:"@id"},{add:{method:"post"},save:{method:"post"},update:{method:"put"}})}]).factory("UserService",["$q","$filter","UserResource",function(e,t,n){var a=[],r=[],i=[],o=this,s={},l={};return this.setHashData=function(e){s=e},this.create=function(t){if("undefined"!=typeof t.id)return o.update(t);var r=e.defer(),i=new n(t);return i.$save({},function(e){e.status&&e.item&&(a.push(e.item),"undefined"==typeof e.item.last_login&&(e.item.last_login="0000-00-00 00:00:00")),r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.changePassword=function(t){var a=e.defer(),r=new n(t);return r.$save({method:"change-password",id:t.id},function(e){e.status?a.resolve(e):a.reject(e)},function(e){a.reject(e.data)}),a.promise},this.changeRoles=function(t){var a=e.defer(),r=new n(t);return r.$save({method:"change-roles"},function(e){e?a.resolve(e):a.reject(e)},function(e){a.reject(e.data)}),a.promise},this.update=function(t){var r=e.defer(),i=new n(t);return i.$update({id:t.id},function(e){if(e.status)for(var t in a)if(a[t].id==e.item.id){a[t]=e.item;break}r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.get=function(t){var a=e.defer();return n.get({id:t},function(e){a.resolve(e)}),a.promise},this.query=function(){var t=e.defer();return n.query(function(e){a=e,t.resolve(e)}),t.promise},this.queryUsersManager=function(){var t=e.defer();return n.query({method:"get-all-user-manager"},function(e){a=e,t.resolve(e)}),t.promise},this.remove=function(t){var r=e.defer();return n["delete"]({id:t},function(e){if(e.status)for(var n in a)if(a[n].id==t){a[n].status="no";break}r.resolve(e)}),r.promise},this.pushUser=function(e){a.push(e)},this.updateUser=function(e){for(var t in a)if(a[t].id==e.id){e.status="yes",a[t]=e;break}},this.changeAvatar=function(t,a){var r=e.defer();return n.save({method:"change-avatar",file:a,id:t},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.resetPassword=function(t){var a=e.defer();return n.save({method:"email",entity:"password",email:t},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.getUsers=function(){return a},this.getUserById=function(e){return l[e]},this.getUsersMap=function(){return l},this.listMap=function(e,t){if("role"==t)for(var n in e)r[e[n].id]=e[n];else for(var n in e)i[e[n].id]=e[n]},this.getMap=function(e){return"role"==e?r:i},this.userBranchManager=function(t){var a=e.defer();return n.query({id:t,method:"get-users-branch-manager"},function(e){a.resolve(e)}),a.promise},this.updatePermissions=function(t,a){var r=e.defer();return n.save({id:t,permissionIds:a,method:"update-permission"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.updateGroup=function(t,a){var r=e.defer();return n.save({id:t,groupIds:a,method:"update-group"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.updateRoles=function(t,a){var r=e.defer();return n.save({id:t,roleIds:a,method:"update-role"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.changeStatus=function(t){var r=e.defer();return n["delete"]({id:t,method:"change-status"},function(e){if(e.status)for(var n in a)if(a[n].id==t){a[n].status="yes";break}r.resolve(e)}),r.promise},this.setData=function(e){a=e;for(var t in e)l[e[t].id]=e[t];return a},this.updateShowDueDateUser=function(t){var a=e.defer(),r=new n(t);return r.$save({method:"update-show-due-date-user"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this}]);var assetmanagerApp=angular.module("assetManager",["ngResource","ui.bootstrap","ngSanitize","ngTable"]);assetmanagerApp.factory("AssetManagerResource",["$resource",function(e){return e("/api/asset-manager/:method/:id",{method:"@method",id:"@id"},{add:{method:"post"},save:{method:"post"},update:{method:"put"},editNameFolder:{method:"edit-name-folder"}})}]).service("AssetManagerService",["AssetManagerResource","$q",function(e,t){var n=this,a=[];this.createFolderProvider=function(a){if("undefined"!=typeof a.id)return n.editFolderAndFile(a);var r=t.defer(),i=new e(a);return i.$save({method:"create-folder"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.uploadNewAsset=function(n){var r=t.defer(),i=new e(n);return i.$save({method:"upload-new-asset"},function(e){0!=e.status&&a.push(e.item),r.resolve(e.item)},function(e){r.resolve(e.data)}),r.promise},this.createNewAsset=function(n){var r=t.defer(),i=new e(n);return i.$save({method:"create-new-asset"},function(e){0!=e.status&&a.push(e.item),r.resolve(e.item)},function(e){r.resolve(e.data)}),r.promise},this.saveFieldFile=function(n){var a=t.defer(),r=new e(n);return r.$save({method:"save-file-asset"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.editFile=function(n){var a=t.defer(),r=new e(n);return r.$save({method:"edit-file"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.crop=function(n){var a=t.defer(),r=new e(n);return r.$save({method:"crop"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.addTagsForPage=function(n,a){var r=t.defer(),i=new e(a);return i.$save({id:n,method:"add-tags"},function(e){0!=e.status,r.resolve(e)},function(e){r.resolve(e.data)}),r.promise},this.getAssetManagerById=function(n){var a=t.defer(),r=new e;return r.$get({id:n},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.setAssetManagers=function(e){return a=e},this.getAssetManagers=function(){return a},this.getUrlImageAsset=function(n){var a=t.defer();return e.get({id:n,method:"get-url-image-asset"},function(e){a.resolve(e)}),a.promise},this.deleteFolderAndAsset=function(n){var a=t.defer(),r=new e;return r.$delete({id:n},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.deleteAssetFile=function(n){var a=t.defer(),r=new e;return r.$get({id:n,method:"delete-file"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.editNameFolder=function(n){var a=t.defer(),r=new e(n);return r.$save({id:n.id,method:"edit-name-folder"},function(e){0!=e.status&&a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.updateContentFile=function(n,a){var r=t.defer(),i=new e(a);return i.$save({id:n,method:"update-content-file"},function(e){r.resolve(e)},function(e){r.resolve(e.data)}),r.promise}}]),angular.module("uls").controller("NotificationController",["$scope","$filter","NotificationService","$controller","$timeout",function(e,t,n,a,r){function i(){}function o(){if(p=!1,c.length>0){var e=c.shift();l(e)}}function s(){}function l(t){if(p)return void c.push(t);if(p=!0,-1==t.data.sender_id)var n=e.baseUrl+"/160x160_avatar_default.png?t=1";else var n=e.users_map[t.data.sender_id].avatar;var a=new Notify("Notification",{icon:n,body:t.data.message,tag:t.data.sender_id,notifyShow:i,notifyClose:o,notifyClick:function(){window.location.href="/"+t.data.href},notifyError:s,timeout:5});a.show()}a("BaseController",{$scope:e}),e.callbackLoadUserFinish=function(){},angular.element("#notification-top").removeClass("hidden"),e.baseUrl=window.baseUrl;var u=10;e.limitTo=u;var d=1;e.notifications=[];var c=[],p=!1;e.amount=0,$(".scroll-noti1").scroll(function(){$(this)[0].scrollHeight-$(this).scrollTop()===$(this).outerHeight()&&e.$apply(function(){e.limitTo=e.limitTo+u})});var f=RowboatPusher.subscribe("notification_ticket");f.bind("Rowboat\\Notification\\Events\\Notifications\\Broadcast\\NotificationTicket",function(t){e.$apply(function(){"undefined"!=typeof t.data.user_id&&-1!=t.data.user_id.indexOf(window.userId)&&(l(t),d=1,e.amount++)})}),e.getNotifications=function(){n.query(d).then(function(t){d&&e.setUserReadThisNotification(),e.notifications=t,e.hightlight=angular.copy(e.amount),e.amount=0,d=0})},e.setUserReadThisNotification=function(){n.setRead().then(function(){})},n.getAmountNotificationsNotRead().then(function(t){e.amount=t.result})}]);var permissionModule=angular.module("notification");permissionModule.factory("NotificationResource",["$resource",function(e){return e("/api/notification/:method/:id",{},{add:{method:"post"},save:{method:"post"}})}]).service("NotificationService",["$q","$filter","NotificationResource",function(e,t,n){var a=[];this.getAmountNotificationsNotRead=function(t){var a=e.defer();return n.get({method:"amount-notifications-not-read"},function(e){a.resolve(e)}),a.promise},this.query=function(t){var r=e.defer();return t?n.query().$promise.then(function(e){a=e,r.resolve(a)}):r.resolve(a),r.promise},this.notificationInvite=function(t){var a=e.defer(),r=new n(t);return r.$save({data:t,method:"invite"},function(e){a.resolve(e)},function(e){a.resolve(e.data)}),a.promise},this.setRead=function(){var t=e.defer(),a=new n;return a.$save({method:"set-read"},function(e){t.resolve(e)},function(e){t.resolve(e.data)}),t.promise}}]),notificationModule=angular.module("notification"),notificationModule.directive("notification",[function(){return{restrict:"AE",scope:{item:"="},replace:!0,templateUrl:baseUrl+"/app/shared/notification/views/notification.html",link:function(){}}}]);var module=angular.module("uls");module.directive("rowboatRequired",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){"undefined"==typeof e.$eval(n.ngModel)&&a.$setValidity("rowboatRequired",!1),t.on("focus",function(r){e.$watch(n.ngModel,function(e){var n="undefined"!=typeof e&&0!=e.length;if(n)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatRequired",n);else if(0==t.parent().find("span").length){t.parent().addClass("error");var r='<span class="control-label">It is required</span>';t.parent().append(r),a.$setValidity("rowboatRequired",n)}})})}}}),module.directive("rowboatLength",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){"undefined"!=typeof e.$eval(n.ngModel)&&e.$eval(n.ngModel).length!=n.rowboatLength&&a.$setValidity("rowboatLength",!1),t.on("focus",function(r){e.$watch(n.ngModel,function(e){var r=n.rowboatLength,i="undefined"!=typeof e&&e.length==r;if(i)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatLength",i);else if(0==t.parent().find("span").length){t.parent().addClass("error");var o='<span class="control-label">Length is '+r+"</span>";t.parent().append(o),a.$setValidity("rowboatLength",i)}})})}}}),module.directive("rowboatMinLength",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){"undefined"!=typeof e.$eval(n.ngModel)&&e.$eval(n.ngModel).length<n.rowboatMinLength&&a.$setValidity("rowboatMinLength",!1),t.on("focus",function(r){e.$watch(n.ngModel,function(e){var r=n.rowboatMinLength,i="undefined"!=typeof e&&e.length>=r;if(i)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatMinLength",i);else if(0==t.parent().find("span").length){t.parent().addClass("error");var o='<span class="control-label">Min length is '+r+"</span>";t.parent().append(o),a.$setValidity("rowboatMinLength",i)}})})}}}),module.directive("rowboatMaxLength",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){"undefined"!=typeof e.$eval(n.ngModel)&&e.$eval(n.ngModel).length>n.rowboatMaxLength&&a.$setValidity("rowboatMaxLength",!1),t.on("focus",function(r){e.$watch(n.ngModel,function(e){var r=n.rowboatMaxLength,i="undefined"!=typeof e&&e.length<=r;if(i)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatMaxLength",i);else if(0==t.parent().find("span").length){t.parent().addClass("error");var o='<span class="control-label">Max length is '+r+"</span>";t.parent().append(o),a.$setValidity("rowboatMaxLength",i)}})})}}}),module.directive("rowboatEmailPattern",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){$pattern=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/,"undefined"==typeof e.$eval(n.ngModel)&&a.$setValidity("rowboatEmailPattern",!1),t.on("blur",function(r){e.$watch(n.ngModel,function(e){var n="undefined"!=typeof e&&$pattern.test(e);if(n)t.parent().find("span").remove(),t.parent().removeClass("error"),a.$setValidity("rowboatEmailPattern",n);else if(0==t.parent().find("span").length){t.parent().addClass("error");var r='<span class="control-label">Email Invalid</span>';t.parent().append(r),a.$setValidity("rowboatEmailPattern",n)}})})}}});var filterDate=angular.module("customFormatDate",[]);filterDate.filter("myDate",["$filter",function(e){return function(t,n){if(null==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var a=e("date")(new Date(String(t)),angular.isUndefined(n)?"MM-dd-yyyy":n);return String(a)}}]).filter("myDateL",["$filter",function(e){return function(t){if(null==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var n=e("date")(new Date(String(t)),"MMMM d, y");return String(n)}}]).filter("myDateTime",["$filter",function(e){return function(t){if(null==t)return"";if("0000-00-00 00:00:00"==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var n=e("date")(new Date(String(t)),"MM-dd-yyyy HH:mm:ss");return String(n)}}]).filter("myDateShortTime",["$filter",function(e){return function(t){if(null==t)return"";if("0000-00-00 00:00:00"==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var n=e("date")(new Date(String(t)),"MM-dd-yyyy h:mma");return String(n)}}]).filter("clientDate",["$filter",function(e){return function(t,n){if(null==t)return"";if("0000-00-00 00:00:00"==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";t=new Date(t),t=new Date(parseInt(new Date(t).getTime())-60*parseInt((new Date).getTimezoneOffset())*1e3);var a=e("date")(new Date(String(t)),angular.isUndefined(n)?"MM-dd-yyyy":n);return String(a)}}]).filter("clientDateTime",["$filter",function(e){return function(t){return e("date")(checkInvalid(t),window.dateTimeFormat)}}]).filter("clientLogDate",["$filter",function(e){return function(t){return e("date")(checkInvalid(t),window.logDate)}}]).filter("clientMediumDate",["$filter",function(e){return function(t){return e("date")(checkInvalid(t),window.mediumDate)}}]).filter("clientShortTime",["$filter",function(e){return function(t){return e("date")(checkInvalid(t),window.shortTime)}}]).filter("clientShortTimeFollowTimezone",["$filter",function(e){return function(t,n){if(null==t)return"";if("Invalid Date"==new Date(t))for(;-1!=String(t).indexOf("-");)t=t.replace("-","/");if("Invalid Date"==new Date(t))return"";var a=e("date")(new Date(String(t)),window.shortTime);return String(a)}}]).filter("formatCurrentDate",["$filter",function(e){return function(e){if(e=checkInvalid(e),!e)return"";e=new Date(e);var t=e.getMonth()+"-"+e.getDate()+"-"+e.getFullYear();return String(t)}}]).filter("formatCurrentTime",["$filter",function(e){return function(e){if(e=checkInvalid(e),!e)return"";e=new Date(e);var t=e.getHours()>=12?"pm":"am",n=parseInt(e.getHours())%12;n=n?10>n?"0"+n:n:12;var a=parseInt(e.getMinutes())<10?"0"+e.getMinutes():e.getMinutes(),r=parseInt(e.getSeconds())<10?"0"+e.getSeconds():e.getSeconds(),i=n+"-"+a+"-"+r+" "+t;return String(i)}}]).filter("formatCurrentShortTime",["$filter",function(e){return function(e){if(e=checkInvalid(e),!e)return"";e=new Date(e);var t=e.getHours()>=12?"pm":"am",n=parseInt(e.getHours())%12;n=n?10>n?"0"+n:n:12;var a=parseInt(e.getMinutes())<10?"0"+e.getMinutes():e.getMinutes(),r=n+":"+a+" "+t;return String(r)}}]);var checkInvalid=function(e,t){if(null==e)return"";if("Invalid Date"==new Date(e))for(;-1!=String(e).indexOf("-");)e=e.replace("-","/");return"Invalid Date"==new Date(e)?"":(e=new Date(e),e=new Date(parseInt(new Date(e).getTime())-60*parseInt((new Date).getTimezoneOffset())*1e3),new Date(String(e)))};angular.module("nlcFilter").filter("elapsedtime",function(){return function(e){return humanized_time_span(e)}});var translation=angular.module("translation",[]);translation.filter("trans",["$filter",function(e){return function(e,t){return null==e?"":window.translations[t][e]}}]);var selectLevel=angular.module("helpEditorDirective",[]),version=5;selectLevel.directive("helpEditorDirective",["$timeout","$filter",function(e,t){return{require:"?ngModel",restrict:"EA",scope:{items:"=",text:"@",selectedItems:"=selectedItem",onClick:"&"},replace:!0,templateUrl:baseUrl+"/app/components/user/help-editor/view/view-help.html?v="+(new Date).getTime(),link:function(t,n,a,r){t.description="",t.recursiveGetDescription=function(e){angular.forEach(e,function(e,n){e.parent=!1,t.description+='<strong class="space-topic" id="_'+e._id+'">'+e.name+"</strong>"+e.description,e.subFolder.length>0&&t.recursiveGetDescription(e.subFolder)})},t.getDesctiption=function(){angular.forEach(t.items,function(e,n){e.parent=!0,t.description+='<h4 id="_'+e._id+'" class="c-primary">'+e.name+'</h4><div class="space-area user-ad-area">'+e.description,t.recursiveGetDescription(e.subFolder),t.description+="</div>"})},t.getDesctiption(),t.goToAnchorWithId=function(e){window.location.href="#"+e,$("#fix-modal-top").scrollTop(0)},e(function(){$(".sub-select-"+t.items[0]._id).addClass("in")})}}}]),google.load("visualization","1",{packages:["corechart","bar"]}),google.setOnLoadCallback(drawPageStatusChart),google.setOnLoadCallback(drawPageUpdatesChart),google.setOnLoadCallback(drawLanguageChart),google.setOnLoadCallback(drawVisitorsChart),google.setOnLoadCallback(drawCollumnVisitorsandLeads);var Dashboard=angular.module("uls");Dashboard.controller("dashboardController",["$controller","$scope","$modal","$filter","$timeout","ngTableParams","dashboardService","$compile",function(e,t,n,a,r,i,o,s){function l(e,t){return e/t*100}function u(e,t){return t?(e.percentNew=l(e["new"],e.total_ticket),e.percentOpen=l(e.open,e.total_ticket),e.percentReviewed=l(e.reviewed,e.total_ticket),e.percentApproved=l(e.approved,e.total_ticket),e.percentClosed=100-(e.percentNew+e.percentOpen+e.percentReviewed+e.percentApproved),e.percent=e.all_percent):(e.percentNew=l(e["new"],e.total_ticket-e.closed),e.percentOpen=l(e.open,e.total_ticket-e.closed),e.percentReviewed=l(e.reviewed,e.total_ticket-e.closed),e.percentApproved=100-(e.percentNew+e.percentOpen+e.percentReviewed),e.percent=e.total_percent),e}function d(){angular.forEach(t.ticketTypes,function(e,n){u(e,t.isShowTicketClosed),e.childs.length>0&&angular.forEach(e.childs,function(e,n){u(e,t.isShowTicketClosed)})})}e("BaseController",{$scope:t}),t.callbackLoadUserFinish=function(){},angular.element(".st-container").removeClass("hidden"),t.tickets_new=angular.copy(window.tickets_new),t.tickets_allopen=angular.copy(window.tickets_allopen),t.states=angular.copy(window.states),t.ticketTypes=angular.copy(window.ticketTypes),t.isShowTicketClosed=!1,t.userDashboardViews=window.userDashboardViews,d(),t.showTicketClosed=function(){t.isShowTicketClosed=!t.isShowTicketClosed,d();var e=t.tableParamsTicketTypes.sorting();if(angular.isDefined(e.percent)){t.tableParamsTicketTypes.sorting(e);var n="asc"==e.percent?"+":"-";t.ticketTypes=formatOrderedDataTicket(t.ticketTypes,n),t.tableParamsTicketTypes.reload()}},t.isSearch=!1,t.filterTicketClosed=function(e){return"closed"!=e.status},t.filterTypeShow=function(e){return-1!=t.typeAvalible.indexOf(e.id)},t.moveDown=function(e){angular.element("#page-loading").css("display","block");var n=$(e.currentTarget).closest(".panel-group"),a=$(n).closest(".ui-sortable"),r=a.children(".panel-group"),i=r.index(n);if(!(i>=r.length)){var o=-(n.height()+20),s=r.eq(i-1).height()+20;n.css({position:"relative"}).animate({top:s},500,function(){
n.css({position:"static",top:"auto"})}),r.eq(i+1).css({position:"relative"}).animate({top:o},500,function(){r.eq(i+1).css({position:"static",top:"auto"}),++t.userDashboardViews[i].sort_order,--t.userDashboardViews[i+1].sort_order;var e=t.userDashboardViews.splice(i,1);t.userDashboardViews.splice(i+1,0,e[0]),t.$apply(),f(t.userDashboardViews)})}},t.moveUp=function(e){angular.element("#page-loading").css("display","block");var n=$(e.currentTarget).closest(".panel-group"),a=$(n).closest(".ui-sortable"),r=a.children(".panel-group"),i=r.index(n),o=-(r.eq(i-1).height()+20),s=+(n.height()+20);n.css({position:"relative"}).animate({top:o},500,function(){n.css({position:"static",top:"auto"})}),r.eq(i-1).css({position:"relative"}).animate({top:s},500,function(){r.eq(i-1).css({position:"static",top:"auto"}),--t.userDashboardViews[i].sort_order,++t.userDashboardViews[i-1].sort_order;var e=t.userDashboardViews.splice(i,1);t.userDashboardViews.splice(i-1,0,e[0]),t.$apply(),f(t.userDashboardViews)})},t.setCollapse=function(e){0==e.height?e.height="auto":e.height=0,angular.element("#page-loading").css("display","block"),o.changeCollapse(e).then(function(n){if(0!=n.status)for(var a in t.userDashboardViews)t.userDashboardViews[a]._id==e._id&&(t.userDashboardViews[a].height=e.height);angular.element("#page-loading").css("display","none")})},formatSortChildTicket=function(e,t){return e.childs.length&&("+"==t?e.childs=_.sortBy(e.childs,"percent"):e.childs=_.sortBy(e.childs,"percent").reverse()),e},formatOrderedDataTicket=function(e,n){var a=[],r=[];return angular.forEach(e,function(e,i){t.isShowTicketClosed?null===e.all_percent?r.push(e):a.push(e):null===e.total_percent?r.push(e):a.push(e),e=formatSortChildTicket(e,n)}),r=_.sortBy(r,"name"),"-"==n?a=a.concat(r):"+"==n&&(a=r.concat(a)),a},t.tableParamsNewTicket=new i({page:1,count:10,sorting:{priority:"asc"},filter:{url:""}},{total:t.tickets_new.length,getData:function(e,n){var r=n.filter()?a("filter")(t.tickets_new,n.filter()):t.tickets_new,i=n.sorting()?a("orderBy")(r,n.orderBy()):r;n.total(r.length),e.resolve(i.slice((n.page()-1)*n.count(),n.page()*n.count()))}}),t.tableParamsTicketTypes=new i({page:1,count:t.ticketTypes.length,sorting:{name:"asc"},filter:{}},{counts:[],total:1,getData:function(e,n){var r=n.filter()?a("filter")(t.ticketTypes,n.filter()):t.ticketTypes,i=n.sorting()?a("orderBy")(r,n.orderBy()):r;n.orderBy().indexOf("-percent")>-1?i=formatOrderedDataTicket(i,"-"):n.orderBy().indexOf("+percent")>-1&&(i=formatOrderedDataTicket(i,"+")),n.total(r.length),e.resolve(i.slice((n.page()-1)*n.count(),n.page()*n.count()))}}),t.tableParamsAllOpenTicket=new i({page:1,count:10,sorting:{priority:"asc"},filter:{url:""}},{total:t.tickets_allopen.length,getData:function(e,n){var r=n.filter()?a("filter")(t.tickets_allopen,n.filter()):t.tickets_allopen,i=n.sorting()?a("orderBy")(r,n.orderBy()):r;n.total(r.length),e.resolve(i.slice((n.page()-1)*n.count(),n.page()*n.count()))}});var c=RowboatPusher.subscribe("notification_ticket");c.bind("Rowboat\\Notification\\Events\\Notifications\\Broadcast\\NotificationTicket",function(e){angular.isDefined(e)&&e.sender_id!=window.userId&&t.$apply(function(){p()})});var c=RowboatPusher.subscribe("ticket");c.bind("Rowboat\\Ticket\\Events\\Ticket\\Broadcast\\TicketCreated",function(e){angular.isDefined(e)&&e.sender_id!=window.userId&&t.$apply(function(){p()})});var c=RowboatPusher.subscribe("ticket");c.bind("Rowboat\\Ticket\\Events\\Ticket\\Broadcast\\TicketFolowing",function(e){angular.isDefined(e)&&e.userId!=window.userId&&t.$apply(function(){p()})});var c=RowboatPusher.subscribe("ticket");c.bind("Rowboat\\Ticket\\Events\\Ticket\\Broadcast\\TicketAssigned",function(e){angular.isDefined(e)&&e.sender.id!=window.userId&&t.$apply(function(){p()})});var c=RowboatPusher.subscribe("ticket");c.bind("Rowboat\\Ticket\\Events\\Ticket\\Broadcast\\TicketInvite",function(e){angular.isDefined(e)&&e.sender.id!=window.userId&&t.$apply(function(){p()})});var p=function(){o.getActionRequiredByMe().then(function(e){t.tickets_new=e.tickets_new,t.tickets_allopen=e.tickets_allopen,t.states=e.states,t.tableParamsNewTicket.reload(),t.tableParamsAllOpenTicket.reload()})};t.goToTaskManager=function(e,t,n){null!=e.percent&&o.setSessionFilterTicketType(e.id,e.parent_id,t,n).then(function(e){e.status&&window.open(window.baseUrl+"/support/state/all_open","")})},t.selectTypeToShowDashBoard=function(){var e="/dashboard/select-type-to-show-dashboard?v="+(new Date).getTime(),a=n.open({animation:!0,templateUrl:window.baseUrl+e,controller:"SelectTypeDashboard",size:null,resolve:{}});a.result.then(function(e){null==e.parent_id?t.ticketTypes.push(e):angular.forEach(t.ticketTypes,function(t,n){t.id==e.parent_id&&t.childs.push(e)}),d(),t.tableParamsTicketTypes.reload()})},t.selectType=function(e,n){if(angular.isUndefined(t.typeSelected)&&(t.typeSelected=[]),1==e.target.checked)-1==t.typeSelected.indexOf(n.id)&&(n.checked=!0,t.typeSelected.push(n.id));else{var a=t.typeSelected.indexOf(n.id);a>-1&&(n.checked=!1,t.typeSelected.splice(a,1))}},t.removeTypeOnDashBoard=function(){if(angular.isUndefined(t.typeSelected)||0==t.typeSelected.length)return void alert("Select a type to remove.");var e=confirm("Do you want to remove type?");e&&o.removeTypeOnDashboard(t.typeSelected).then(function(e){e.status&&($result=[],angular.forEach(t.ticketTypes,function(e,n){-1==t.typeSelected.indexOf(e.id)&&null==e.parent_id&&($childs=[],_.find(e.childs,function(e){-1==t.typeSelected.indexOf(e.id)&&$childs.push(e)}),e.childs=$childs,$result.push(e))}),t.ticketTypes=$result),d(),t.typeSelected=[],t.tableParamsTicketTypes.reload()})},t.sortableOptions={axis:"y",handle:"a.my-handle-field",start:function(e,t){$(this).attr("data-previndex",t.item.index())},update:function(e,t){},stop:function(e,n){$(this).attr("data-previndex"),n.item.index();f(t.userDashboardViews)}};var f=function(e){o.saveSort(e).then(function(e){0!=e.status&&angular.element("#page-loading").css("display","none")})}}]),Dashboard.controller("SelectTypeDashboard",["$scope","$modalInstance","$filter","$timeout","ngTableParams","dashboardService","$compile",function(e,t,n,a,r,i,o){e.cancel=function(){t.dismiss("cancel")},e.selectTypeShow=function(n){e.errorType=!1,$("#btnAddType").attr("disabled","disabled"),angular.isDefined(n)?i.selectTypeShow(n.id).then(function(e){e.status&&t.close(e.type)}):(e.errorType=!0,$("#btnAddType").removeAttr("disabled"))}}]);var Dashboard=angular.module("uls");Dashboard.factory("dashboardResource",["$resource",function(e){return e("/api/dashboard/:method/:id",{method:"@method",id:"@id"},{add:{method:"post"},save:{method:"post"},update:{method:"put"}})}]),Dashboard.service("dashboardService",["dashboardResource","$q",function(e,t){this.getActionRequiredByMe=function(){var n=t.defer();return e.get(function(e){n.resolve(e)}),n.promise},this.setSessionFilterTicketType=function(n,a,r,i){var o=t.defer();data={typeId:n,typeParent:a,status:r,filterIncludeClosed:i};var s=new e(data);return s.$save({method:"set-session-filter-ticket-type"},function(e){o.resolve(e)}),o.promise},this.selectTypeShow=function(n){var a=t.defer();data={typeId:n};var r=new e(data);return r.$save({method:"select-type-show"},function(e){a.resolve(e)}),a.promise},this.saveSort=function(n){var a=t.defer(),r=new e(n);return r.$save({method:"save-sort"},function(e){a.resolve(e)}),a.promise},this.removeTypeOnDashboard=function(n){var a=t.defer();data={types:n};var r=new e(data);return r.$save({method:"remove-type-dashboard"},function(e){a.resolve(e)}),a.promise},this.changeCollapse=function(n){var a=t.defer(),r=new e(n);return r.$save({method:"change-collapse"},function(e){a.resolve(e)}),a.promise}}]);